#include <machine.h>
#include "types.h"
#include "tuneup.h"
#include "func_tbl.h"
#include "SWAN_L_C.h"
#include "SWANMAIN.h"
#include "SPRINTF.h"
#include "SYSTEM.h"
#include "SOUND_CODE.h"
#include "PUT_TEXT.h"
#include "MEMORY.h"
#include "PAD.h"
#include "story.h"
#include "m_cpu2p.h"
#include "m_game.h"
#include "stagesel.h"
#include "func_tbl.h"

/*
tune_func
location_table
position_table
*/ 

typedef void (near * tune_func_ptr)(u16, u16);

static void near unk_8DC88(u16 a, u16 b, u16 c, u16 d, u16 e, u16 f);
static void near unk_8DE28(u16 a, u16 b, u16 c, u16 d, u16 e, u16 f);
static void near unk_8E2E1(u16 a, u16 b, u16 c, u16 d);


static void near unk_8E897(u16 a, u16 b);
static void near unk_8EBE8(u16 a, u16 b);
static void near unk_8EE52(u16 a, u16 b);
static void near unk_8F0C3(u16 a, u16 b);
static void near unk_8F294(u16 a, u16 b);
static void near unk_8F517(u16 a, u16 b);
static void near unk_8F780(u16 a, u16 b);

const tune_func_ptr far tune_func[] = {
    unk_8EBE8, 
	unk_8E897,
	unk_8EE52,
	unk_8F0C3,
	unk_8F294,
	unk_8F517,
	unk_8F780 
};

const u8 far location_table[] = {
    0x00, 0x00, 0x00, 0x00, 0x1C, 0x00, 0x12, 0x00, 0x08, 0x00, 0x90, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x00, 0x00, 0x90, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x98, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x10, 0x00, 0x90, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0x00, 0xD8, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x00, 0x00, 0xF0, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x08, 0x01, 0x01, 0x00, 0x01, 0x00,
    0x08, 0x00, 0xE0, 0x00, 0x01, 0x00, 0x01, 0x00, 0x08, 0x00, 0xF8, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x08, 0x00, 0x10, 0x01, 0x01, 0x00, 0x01, 0x00, 0x60, 0x00, 0xA0, 0x00, 0x06, 0x00, 0x01, 0x00,
    0x60, 0x00, 0xA8, 0x00, 0x06, 0x00, 0x01, 0x00, 0x60, 0x00, 0xB0, 0x00, 0x06, 0x00, 0x01, 0x00,
    0x60, 0x00, 0xB8, 0x00, 0x06, 0x00, 0x01, 0x00, 0x60, 0x00, 0xC0, 0x00, 0x06, 0x00, 0x01, 0x00,
    0x60, 0x00, 0xC8, 0x00, 0x06, 0x00, 0x01, 0x00, 0x90, 0x00, 0x90, 0x00, 0x0A, 0x00, 0x01, 0x00,
    0x00, 0x00, 0xA0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x20, 0x00, 0xA0, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x40, 0x00, 0xA0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x00, 0x00, 0xA8, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x00, 0x00, 0xB0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x20, 0x00, 0xB0, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x40, 0x00, 0xB0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x00, 0x00, 0xB8, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x20, 0x00, 0xB8, 0x00, 0x04, 0x00, 0x01, 0x00, 0x40, 0x00, 0xB8, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x00, 0x00, 0xC0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x00, 0x00, 0xC8, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x20, 0x00, 0xC8, 0x00, 0x04, 0x00, 0x01, 0x00, 0x40, 0x00, 0xC8, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x00, 0x00, 0xD0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x20, 0x00, 0xD0, 0x00, 0x04, 0x00, 0x01, 0x00,
    0x40, 0x00, 0xD0, 0x00, 0x04, 0x00, 0x01, 0x00, 0x90, 0x00, 0xB0, 0x00, 0x0A, 0x00, 0x01, 0x00,
    0x90, 0x00, 0xC8, 0x00, 0x0A, 0x00, 0x01, 0x00, 0x90, 0x00, 0xB8, 0x00, 0x0A, 0x00, 0x01, 0x00,
    0x90, 0x00, 0xD0, 0x00, 0x0A, 0x00, 0x01, 0x00, 0xC0, 0x00, 0xD8, 0x00, 0x04, 0x00, 0x02, 0x00,
    0xC0, 0x00, 0xE8, 0x00, 0x04, 0x00, 0x02, 0x00, 0x90, 0x00, 0x98, 0x00, 0x01, 0x00, 0x01, 0x00,
    0x90, 0x00, 0xA0, 0x00, 0x01, 0x00, 0x01, 0x00, 0x90, 0x00, 0xA8, 0x00, 0x01, 0x00, 0x01, 0x00 
};

const u8 far position_table[] = {
    0x00, 0x00, 0x00, 0x00, 0x78, 0x00, 0x10, 0x00, 0x78, 0x00, 0x18, 0x00, 0xC0, 0x00, 0x10, 0x00,
    0xB8, 0x00, 0x30, 0x00, 0xB8, 0x00, 0x38, 0x00, 0xB8, 0x00, 0x40, 0x00, 0xB8, 0x00, 0x50, 0x00,
    0xB8, 0x00, 0x58, 0x00, 0xB8, 0x00, 0x60, 0x00, 0xB8, 0x00, 0x70, 0x00, 0x60, 0x00, 0x38, 0x00,
    0x08, 0x00, 0x38, 0x00, 0x08, 0x00, 0x28, 0x00, 0x60, 0x00, 0x28, 0x00, 0xB8, 0x00, 0x20, 0x00,
};

static void unk_8F7F2();

static void near unk_8DA68(u16 a, u16 b, u16 c, u16 d, u16 e, char far *f)
{
	font_put2XY; //Force include
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0012");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("LEA	DI,[BP-0x09].B");
	ASM_INLINE("XOR	SI,SI");
	ASM_INLINE("JMP	_8DA86");
ASM_INLINE("_8DA7A:");
	ASM_INLINE("LES	BX,[BP+0x06]");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	BL,ES:[BX].B");
	ASM_INLINE("MOV	-0x09[BP+SI].B,BL");
	ASM_INLINE("INC	SI");
ASM_INLINE("_8DA86:");
	ASM_INLINE("CMP	SI,0x0009");
	ASM_INLINE("JL	_8DA7A");
	ASM_INLINE("MOV	SI,0x000E");
	ASM_INLINE("MOV	BX,0xBAE8");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	SI,AX");
	ASM_INLINE("MOV	[BP-0x0D].W,SI");
	ASM_INLINE("MOV	[BP-0x0B].W,BX");
	ASM_INLINE("MOV	SI,0x000E");
	ASM_INLINE("MOV	AX,0xBAFE");
	ASM_INLINE("POP	BX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("ADD	SI,BX");
	ASM_INLINE("MOV	[BP-0x11].W,SI");
	ASM_INLINE("MOV	[BP-0x0F].W,AX");
	ASM_INLINE("JMP	_8DC78");
ASM_INLINE("_8DAB5:");
	ASM_INLINE("MOV	AL,[DI].B");
	ASM_INLINE("CMP	AL,0x2D");
	ASM_INLINE("JZ	_8DB23");
	ASM_INLINE("CMP	AL,0x20");
	ASM_INLINE("JZ	_8DAC2");
	ASM_INLINE("JMP	_8DB89");
ASM_INLINE("_8DAC2:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("DEC	AX");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	CX,ES:[SI+0x04].W");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	DX,ES:[SI+0x06].W");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
	ASM_INLINE("JMP	_8DC74");
ASM_INLINE("_8DB23:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	SI,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("INC	BX");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	CX,ES:[SI+0x04].W");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	DX,ES:[SI+0x06].W");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
	ASM_INLINE("JMP	_8DC74");
ASM_INLINE("_8DB89:");
	ASM_INLINE("MOV	AL,[DI].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CALLF	0x000E, 0x9212"); //_LMUL
	ASM_INLINE("CMP	AX,0x0050");
	ASM_INLINE("JGE	_8DC06");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	AL,[DI].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CALLF	0x000E, 0x9212"); //_LMUL
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("SUB	SI,0x0041");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	CX,ES:[SI+0x04].W");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	DX,ES:[SI+0x06].W");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
	ASM_INLINE("JMP	_8DC74");
ASM_INLINE("_8DC06:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	AL,[DI].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CALLF	0x000E, 0x9212"); //_LMUL
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("SUB	SI,0x0051");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x11]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("LES	BX,[BP-0x0D]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("INC	BX");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	CX,ES:[SI+0x04].W");
	ASM_INLINE("LES	SI,[BP-0x0D]");
	ASM_INLINE("MOV	DX,ES:[SI+0x06].W");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
ASM_INLINE("_8DC74:");
	ASM_INLINE("INC	DI");
	ASM_INLINE("ADD	CX,0x0008");
ASM_INLINE("_8DC78:");
	ASM_INLINE("CMP	[DI].B,0x00");
	ASM_INLINE("JZ	_8DC80");
	ASM_INLINE("JMP	_8DAB5");
ASM_INLINE("_8DC80:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static void near unk_8DC88(u16 a, u16 b, u16 c, u16 d, u16 e, u16 f)
{
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0008");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	SI,CX");
	ASM_INLINE("MOV	DI,DX");
	ASM_INLINE("MOV	DX,0x000E");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	DX,AX");
	ASM_INLINE("MOV	[BP-0x04].W,DX");
	ASM_INLINE("MOV	[BP-0x02].W,CX");
	ASM_INLINE("MOV	CX,0x000E");
	ASM_INLINE("MOV	AX,0xBAFE");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("ADD	CX,BX");
	ASM_INLINE("MOV	[BP-0x08].W,CX");
	ASM_INLINE("MOV	[BP-0x06].W,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x08]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DI");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x08]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,[BP+0x06].W");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	BX,ES:[BX].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,BX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	CX,ES:[BX+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	DX,ES:[BX+0x06].W");
	ASM_INLINE("POP	BX");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x08]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DI");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x08]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("ADD	AX,0x0008");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	CX,ES:[BX].W");
	ASM_INLINE("SAR	CX,1");
	ASM_INLINE("SAR	CX,1");
	ASM_INLINE("SAR	CX,1");
	ASM_INLINE("MOV	AX,[BP+0x06].W");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("ADD	CX,DX");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	CX,ES:[BX+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	DX,ES:[BX+0x06].W");
	ASM_INLINE("POP	BX");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static void near unk_8DD97(u16 a, u16 b, s16 c, s16 d, u16 e)
{
	s16 far *lPtr = location_table + (a << 3);
	s16 far *pPtr = position_table + (b << 2);
	
	font_put2XY(lPtr[0] >> 3, lPtr[1] >> 3, lPtr[2], lPtr[3], pPtr[0] + c >> 3, pPtr[1] + d >> 3, e, G_TUNEUP_char_adr);
}

static void near unk_8DE28(u16 a, u16 b, u16 c, u16 d, u16 e, u16 f)
{
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0008");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	DI,0x000E");
	ASM_INLINE("MOV	SI,0xBAE8");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	DI,AX");
	ASM_INLINE("MOV	[BP-0x04].W,DI");
	ASM_INLINE("MOV	[BP-0x02].W,SI");
	ASM_INLINE("MOV	DI,0x000E");
	ASM_INLINE("MOV	AX,0xBAFE");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("ADD	DI,BX");
	ASM_INLINE("MOV	[BP-0x08].W,DI");
	ASM_INLINE("MOV	[BP-0x06].W,AX");
	ASM_INLINE("MOV	AX,[BP+0x06].W");
	ASM_INLINE("CMP	AX,0x0019");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JZ	_8DE93");
	ASM_INLINE("CMP	AX,0x0014");
	ASM_INLINE("JZ	_8DE8E");
	ASM_INLINE("CMP	AX,0x000F");
	ASM_INLINE("JZ	_8DE89");
	ASM_INLINE("CMP	AX,0x000C");
	ASM_INLINE("JZ	_8DE84");
	ASM_INLINE("CMP	AX,0x000A");
	ASM_INLINE("JZ	_8DE7F");
	ASM_INLINE("CMP	AX,0x0005");
	ASM_INLINE("JNZ	_8DE96");
	ASM_INLINE("XOR	SI,SI");
	ASM_INLINE("JMP	_8DE96");
ASM_INLINE("_8DE7F:");
	ASM_INLINE("MOV	SI,0x0001");
	ASM_INLINE("JMP	_8DE96");
ASM_INLINE("_8DE84:");
	ASM_INLINE("MOV	SI,0x0002");
	ASM_INLINE("JMP	_8DE96");
ASM_INLINE("_8DE89:");
	ASM_INLINE("MOV	SI,0x0003");
	ASM_INLINE("JMP	_8DE96");
ASM_INLINE("_8DE8E:");
	ASM_INLINE("MOV	SI,0x0004");
	ASM_INLINE("JMP	_8DE96");
ASM_INLINE("_8DE93:");
	ASM_INLINE("MOV	SI,0x0005");
ASM_INLINE("_8DE96:");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBB03");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("PUSH	[BP+0x04].W");
	ASM_INLINE("LES	BX,[BP-0x08]");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x08]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("SAR	AX,1");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	BX,ES:[BX+0x02].W");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("SAR	BX,1");
	ASM_INLINE("LES	SI,[BP-0x04]");
	ASM_INLINE("MOV	CX,ES:[SI+0x04].W");
	ASM_INLINE("LES	SI,[BP-0x04]");
	ASM_INLINE("MOV	DX,ES:[SI+0x06].W");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static void near unk_8DEF9(struct TuneupWork *work)
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8DF29");
ASM_INLINE("_8DF1E:");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	[BX].B,0xFF");
	ASM_INLINE("INC	AX");
ASM_INLINE("_8DF29:");
	ASM_INLINE("CMP	AX,0x0008");
	ASM_INLINE("JL	_8DF1E");
	ASM_INLINE("MOV	CX,0x0003");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8DF7B");
ASM_INLINE("_8DF35:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JZ	_8DF7A");
	ASM_INLINE("MOV	BX,0xA711");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,CX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	//ASM_INLINE("CMP	ES:[BX+0x0000].W,0x0003");
	ASM_OP6(0x26,0x83,0xBF,0x00,0x00,0x03);
	ASM_INLINE("JZ	_8DF7A");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("JMP	_8DF65");
ASM_INLINE("_8DF55:");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("CMP	AX,CX");
	ASM_INLINE("JZ	_8DF6A");
	ASM_INLINE("INC	DX");
ASM_INLINE("_8DF65:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JL	_8DF55");
ASM_INLINE("_8DF6A:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("POP	AX");
	ASM_INLINE("JNZ	_8DF7A");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	[BX].B,CL");
	ASM_INLINE("INC	AX");
ASM_INLINE("_8DF7A:");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8DF7B:");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("MOV	DX,0x000C");
	ASM_INLINE("MUL	DX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	BX,ES:[BX].W");
	ASM_INLINE("CMP	BX,0x0000");
	ASM_INLINE("POP	AX");
	ASM_INLINE("JGE	_8DF35");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static s16 near unk_8DFA1(struct TuneupWork *work, u16 b)
{
/*	s16 i;
	u16 val;

	for(i = 0; b != val && ++i < 8; )
	{
		val = aulist[(u8)*work->unk12].moves[i];
	}

	if(i >= 8)
	{
		return 0;
	}
	//else
	{
		return 1;
	}

	//return (i >= 8) ? 0 : 1;
*/

	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("MOV	CX,BX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("JMP	_8DFD3");
ASM_INLINE("_8DFAD:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	DX,0x000F");
	ASM_INLINE("MUL	DX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("POP	DX");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,ES:[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("CMP	CX,AX");
	ASM_INLINE("JZ	_8DFD8");
	ASM_INLINE("INC	DX");
ASM_INLINE("_8DFD3:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JL	_8DFAD");
ASM_INLINE("_8DFD8:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JL	_8DFE1");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8DFE4");
ASM_INLINE("_8DFE1:");
	ASM_INLINE("MOV	AX,0x0001");
ASM_INLINE("_8DFE4:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

void tuneup_init()
{
	s16 i;
	u16 val;
	s8 *ptr;
	struct TuneupWork *work;

  	ptr = (SAVE_DATA_START[0x0A] * 0x1d + (SAVE_DATA_START + 0x3C));

	task_delete();
	work = (struct TuneupWork *)memalloc(sizeof (struct TuneupWork));
	if (work != NULL)
	{
		task_append((task_pointer)unk_8F7F2, (u16)work);
		work->unk8 = 0;
		work->unk6 = 0;
		work->unk4 = 0;
		work->unk2 = 0;
		work->unk0 = 0;
		work->unk12 = ptr;

		for(i = 0; i < 8; i++)
		{
			work->unkA[i] = -1;
		}
		unk_8DEF9(work);
		nbg_ddf(0,0);
		nbg_ddf(1,0);
		spr_ddf(0);
		bitmap(1);
		unk_8DD97(0,0,0,0,1);
		unk_8DA68(8,1,0,0,1,chara_name[(u8)ptr[0]]);
		unk_8DA68(8,2,0,0,1,type_name[aulist[(u8)ptr[0]].type]);
		unk_8DC88(4,3,0,0,1,(u8)ptr[4]);
		unk_8DD97(0x25,0xd,0,0,1);
		unk_8DD97(0x23,0xe,0,0,1);
		unk_8DD97(0x27,0xf,0,0,1);
		unk_8DD97(0x12,4,0,0,1);
		unk_8DD97(0x15,5,0,0,1);
		unk_8DD97(0x16,6,0,0,1);
		unk_8DC88(5,5,0x10,0,1,(u8)ptr[2]);
		val = tuneup_table[0][aulist[(u8)ptr[0]].type];
		unk_8DE28(0x29,6,8,0,1,val);
		unk_8DD97(0x19,7,0,0,1);
		unk_8DD97(0x1c,8,0,0,1);
		unk_8DD97(0x1d,9,0,0,1);
		unk_8DC88(5,8,0x10,0,1,(u8)ptr[3]);
		val = tuneup_table[1][aulist[(u8)ptr[0]].type];
		unk_8DE28(0x29,9,8,0,1,val*5);
		unk_8DD97(0x20,10,0,0,1);
		unk_8E2E1(work,1,1,0);
		unk_8E2E1(work,0,0,0);
		tune_func[work->unk0](work, 4);
		bgmreq(5);
		fade_tone(0);
		fade_out(100);
		fade_run();
		fade_in(10);
		nbg_ddf(1,1);
	}
}

static void near unk_8E2E1(u16 a, u16 b, u16 c, u16 d)
{
	weapon_name;
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0002");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("MOV	SI,BX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("JMP	_8E312");
ASM_INLINE("_8E2F3:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0011");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("POP	DX");
	ASM_INLINE("INC	DX");
	ASM_INLINE("POP	CX");
ASM_INLINE("_8E312:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JL	_8E2F3");
	ASM_INLINE("TEST	CX,CX");
	ASM_INLINE("JNZ	_8E31E");
	ASM_INLINE("JMP	_8E467");
ASM_INLINE("_8E31E:");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("MOV	[BP-0x02].W,0x0000");
	ASM_INLINE("JMP	_8E45C");
ASM_INLINE("_8E328:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JGE	_8E338");
	ASM_INLINE("JMP	_8E45B");
ASM_INLINE("_8E338:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("CMP	[BX].B,0x03");
	ASM_INLINE("JL	_8E389");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("ADD	SI,0x0005");
	ASM_INLINE("ADD	SI,DX");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,0x000C");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("POP	DX");
	ASM_INLINE("JMP	_8E38B");
ASM_INLINE("_8E389:");
	ASM_INLINE("XOR	AX,AX");
ASM_INLINE("_8E38B:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0040");
	ASM_INLINE("MOV	DX,[BP-0x02].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,SEG weapon_name_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("POP	DX");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	//ASM_INLINE("PUSH	ES:[BX+0x0002].W");
	ASM_OP5(0x26,0xFF,0xB7,0x02,0x00);
	//ASM_INLINE("PUSH	ES:[BX+0x0000].W");
	ASM_OP5(0x26,0xFF,0xB7,0x00,0x00);
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0008");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("MOV	DX,[BP-0x02].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DA68_");
	ASM_INLINE("ADD	SP,0x0006");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("CALL	unk_8DFA1_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("JNZ	_8E432");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[BP-0x02].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("POP	CX");
	ASM_INLINE("JMP	_8E457");
ASM_INLINE("_8E432:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0040");
	ASM_INLINE("MOV	DX,[BP-0x02].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("POP	CX");
ASM_INLINE("_8E457:");
	ASM_INLINE("INC	[BP-0x02].W");
	ASM_INLINE("POP	DX");
ASM_INLINE("_8E45B:");
	ASM_INLINE("INC	DX");
ASM_INLINE("_8E45C:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JGE	_8E464");
	ASM_INLINE("JMP	_8E328");
ASM_INLINE("_8E464:");
	ASM_INLINE("JMP	_8E54C");
ASM_INLINE("_8E467:");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("JMP	_8E544");
ASM_INLINE("_8E46C:");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JG	_8E47B");
	ASM_INLINE("JMP	_8E543");
ASM_INLINE("_8E47B:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("ADD	SI,0x000A");
	ASM_INLINE("ADD	SI,DX");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,0x000C");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0040");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,SEG weapon_name_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("POP	DX");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	CX");
	//ASM_INLINE("PUSH	ES:[BX+0x0002].W");
	ASM_OP5(0x26,0xFF,0xB7,0x02,0x00);
	//ASM_INLINE("PUSH	ES:[BX+0x0000].W");
	ASM_OP5(0x26,0xFF,0xB7,0x00,0x00);
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0008");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DA68_");
	ASM_INLINE("ADD	SP,0x0006");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("INC	[BP-0x02].W");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	DX");
ASM_INLINE("_8E543:");
	ASM_INLINE("INC	DX");
ASM_INLINE("_8E544:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JGE	_8E54C");
	ASM_INLINE("JMP	_8E46C");
ASM_INLINE("_8E54C:");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static u16 near unk_8E557(struct TuneupWork *work, u16 b, u16 c, u16 d, s16 e)
{
/*	u16 val;
	s8 *ptr;

	if((e < 8) && (0 > e))
	{
		if(c)
		{
			if (0 <= *(work->unk12 + 5 + e))
			{
				if (3 <= *(work->unk12 + 5 + e))
				{
					val = tuneup_table[0][aulist[(u8)*work->unk12].type];
					val = aulist[(u8)work->unk12[5 + e]].type;
				}
				else
				{
					val = 0;
				}

				unk_8DC88(b + 5,c + 0xb,0x40,e << 3,1,val);
				unk_8DA68(b + 8,c + 0xb,8,e << 3,1,aulist[(u8)*(work->unk12 + e)].type);
				val = unk_8DFA1(work, *(work->unk12 + 5 + e));

				if (val == 0)
				{
					unk_8DD97(b + 1,c + 0xb,0,e << 3,1);
				}
				else
				{
					unk_8DC88(b + 5,c + 0xb,0x40,e << 3,1,0);
				}

				return 1;
			}
		}
		else if (0 < work->unkA[e])
		{
			unk_8DC88(b + 5, 0xb, 0x40, e << 3, 1, aulist[(u8)work->unkA[e]].type);
			unk_8DA68(b + 8, c + 0xb, 8, e << 3, 1, aulist[(u8)work->unkA[e] * 4].type);
			unk_8DD97(b + 1, c + 0xb, 0, e << 3, 1);
			return 1;
		}
	}*/
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("MOV	SI,BX");
	ASM_INLINE("CMP	[BP+0x04].W,0x0008");
	ASM_INLINE("JGE	_8E56E");
	ASM_INLINE("CMP	[BP+0x04].W,0x0000");
	ASM_INLINE("JGE	_8E573");
ASM_INLINE("_8E56E:");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8E780");
ASM_INLINE("_8E573:");
	ASM_INLINE("TEST	CX,CX");
	ASM_INLINE("JNZ	_8E57A");
	ASM_INLINE("JMP	_8E6A7");
ASM_INLINE("_8E57A:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[BP+0x04].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JGE	_8E58B");
	ASM_INLINE("JMP	_8E77E");
ASM_INLINE("_8E58B:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[BP+0x04].W");
	ASM_INLINE("CMP	[BX].B,0x03");
	ASM_INLINE("JL	_8E5DA");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("ADD	SI,0x0005");
	ASM_INLINE("ADD	SI,[BP+0x04].W");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,0x000C");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("JMP	_8E5DC");
ASM_INLINE("_8E5DA:");
	ASM_INLINE("XOR	AX,AX");
ASM_INLINE("_8E5DC:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0040");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,SEG weapon_name_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[BP+0x04].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	CX");
	//ASM_INLINE("PUSH	ES:[BX+0x0002].W");
	ASM_OP5(0x26,0xFF,0xB7,0x02,0x00);
	//ASM_INLINE("PUSH	ES:[BX+0x0000].W");
	ASM_OP5(0x26,0xFF,0xB7,0x00,0x00);
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0008");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DA68_");
	ASM_INLINE("ADD	SP,0x0006");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[BP+0x04].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("CALL	unk_8DFA1_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("JNZ	_8E67E");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("JMP	_8E6A1");
ASM_INLINE("_8E67E:");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0040");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
ASM_INLINE("_8E6A1:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("JMP	_8E780");
ASM_INLINE("_8E6A7:");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[BP+0x04].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JG	_8E6B7");
	ASM_INLINE("JMP	_8E77E");
ASM_INLINE("_8E6B7:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("ADD	SI,0x000A");
	ASM_INLINE("ADD	SI,[BP+0x04].W");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,0x000C");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0040");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,SEG weapon_name_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("ADD	DI,0x000A");
	ASM_INLINE("ADD	DI,[BP+0x04].W");
	ASM_INLINE("MOV	AL,[DI].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	CX");
	//ASM_INLINE("PUSH	ES:[BX+0x0002].W");
	ASM_OP5(0x26,0xFF,0xB7,0x02,0x00);
	//ASM_INLINE("PUSH	ES:[BX+0x0000].W");
	ASM_OP5(0x26,0xFF,0xB7,0x00,0x00);
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0008");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DA68_");
	ASM_INLINE("ADD	SP,0x0006");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("POP	CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("ADD	AX,SI");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[BP+0x04].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("JMP	_8E780");
ASM_INLINE("_8E77E:");
	ASM_INLINE("XOR	AX,AX");
ASM_INLINE("_8E780:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("POP	BP");
}

static s16 unk_8E786(struct TuneupWork *work)
{
/*	s16 i;
	s16 j;
	s16 ret;
	u16 tmp;
	s16 tmp2;
	s16 tmp3;

	
	for(i = 0; (0 <= *(work->unk12 + 5 + i)) && i < 8; i++)
	{
	}

	if(i < 8)
	{	
		return -1;
	}

	tmp =  work->unkA[work->unk2];
	tmp2 = tuneup_table[tmp][aulist[(u8)*work->unk12].type];
	tmp3 = work->unk12[4];
	if (tmp3 >= tmp2)
	{
		work->unk12[4] -= tmp2;
	}
	else
	{
		return 0;
	}

	for(i = 0; i < 8; i++)
	{
		if(0 <= *(work->unk12 + 5 + i))
		{
			break;
		}
	}
	if(i < 7)
	{
		for (j = 6; i <= j; j--)
		{
			work->unk12[j + 5 + 1] = work->unk12[j + 5];
		}
		work->unk12[i + 5] = tmp;
	}
	else
	{
		work->unk12[0xc] = tmp;
	}

	for (i = work->unk2; i < 7; i++)
	{
		work->unkA[i] = work->unkA[i + 1];
	}
	work->unkA[i] = 0;
	return 1;*/

	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8E79E");
ASM_INLINE("_8E790:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8E7A3");
	ASM_INLINE("INC	AX");
ASM_INLINE("_8E79E:");
	ASM_INLINE("CMP	AX,0x0008");
	ASM_INLINE("JL	_8E790");
ASM_INLINE("_8E7A3:");
	ASM_INLINE("CMP	AX,0x0008");
	ASM_INLINE("JL	_8E7AE");
	ASM_INLINE("MOV	AX,0xFFFF");
	ASM_INLINE("JMP	_8E892");
ASM_INLINE("_8E7AE:");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[DI+0x02].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("MOV	AX,SEG aulist_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("SHL	SI,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("MOV	DX,0x000C");
	ASM_INLINE("MUL	DX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	BL,[BX+0x04].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("CMP	BX,AX");
	ASM_INLINE("JL	_8E802");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("SUB	[BX+0x04].B,AL");
	ASM_INLINE("JMP	_8E807");
ASM_INLINE("_8E802:");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8E892");
ASM_INLINE("_8E807:");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("JMP	_8E828");
ASM_INLINE("_8E80B:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("CMP	CX,AX");
	ASM_INLINE("JL	_8E82D");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("CMP	[BX].B,0xFF");
	ASM_INLINE("JZ	_8E82D");
	ASM_INLINE("INC	DX");
ASM_INLINE("_8E828:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JL	_8E80B");
ASM_INLINE("_8E82D:");
	ASM_INLINE("CMP	DX,0x0007");
	ASM_INLINE("JL	_8E83A");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	[BX+0x0C].B,CL");
	ASM_INLINE("JMP	_8E867");
ASM_INLINE("_8E83A:");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("JMP	_8E859");
ASM_INLINE("_8E83F:");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("ADD	SI,0x0005");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("INC	BX");
	ASM_INLINE("ADD	SI,BX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("MOV	[SI].B,AL");
	ASM_INLINE("POP	AX");
	ASM_INLINE("DEC	AX");
ASM_INLINE("_8E859:");
	ASM_INLINE("CMP	AX,DX");
	ASM_INLINE("JGE	_8E83F");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	[BX].B,CL");
ASM_INLINE("_8E867:");
	ASM_INLINE("MOV	CX,[DI+0x02].W");
	ASM_INLINE("JMP	_8E882");
ASM_INLINE("_8E86C:");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("ADD	SI,0x000A");
	ASM_INLINE("ADD	SI,CX");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("INC	AX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("MOV	[SI].B,AL");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8E882:");
	ASM_INLINE("CMP	CX,0x0007");
	ASM_INLINE("JL	_8E86C");
	ASM_INLINE("ADD	DI,0x000A");
	ASM_INLINE("ADD	DI,CX");
	ASM_INLINE("MOV	[DI].B,0x00");
	ASM_INLINE("MOV	AX,0x0001");
ASM_INLINE("_8E892:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8E897(u16 a, u16 b)
{
	put_message; //Force include
	sereq; //Force include
ASM_INLINE("_8E897:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JNZ	_8E8A4");
	ASM_INLINE("JMP	_8EAB4");
ASM_INLINE("_8E8A4:");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JNZ	_8E8AC");
	ASM_INLINE("JMP	_8EA4F");
ASM_INLINE("_8E8AC:");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JNZ	_8E8B4");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E8B4:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JNZ	_8E8BC");
	ASM_INLINE("JMP	_8E9CF");
ASM_INLINE("_8E8BC:");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JNZ	_8E8C4");
	ASM_INLINE("JMP	_8E94F");
ASM_INLINE("_8E8C4:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JZ	_8E8CB");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E8CB:");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("DEC	[SI+0x02].W");
	ASM_INLINE("CMP	[SI+0x02].W,0x0000");
	ASM_INLINE("JGE	_8E902");
	ASM_INLINE("MOV	[SI+0x02].W,0x0000");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E902:");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[SI+0x02].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8E942");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[SI+0x02].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("INC	AX");
	ASM_INLINE("OR	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E942:");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E94F:");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("INC	[SI+0x02].W");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JNZ	_8E995");
	ASM_INLINE("DEC	[SI+0x02].W");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E995:");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[SI+0x02].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8E9C2");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[SI+0x02].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("INC	AX");
	ASM_INLINE("OR	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E9C2:");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8E9CF:");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("CALLF	unk_8E786_, SEG unk_8E786_");
	ASM_INLINE("CMP	AX,0xFFFF");
	ASM_INLINE("JZ	_8EA1E");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JZ	_8EA0B");
	ASM_INLINE("CMP	AX,0x0001");
	ASM_INLINE("JNZ	_8EA2F");
	ASM_INLINE("DEC	[SI+0x02].W");
	ASM_INLINE("CMP	[SI+0x02].W,0x0000");
	ASM_INLINE("JGE	_8E9F2");
	ASM_INLINE("MOV	[SI+0x02].W,0x0000");
ASM_INLINE("_8E9F2:");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("CALL	unk_8EBE8_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("CALL	unk_8E897_");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("JMP	_8EA2F");
ASM_INLINE("_8EA0B:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,0x8226");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EA2F");
ASM_INLINE("_8EA1E:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,0x8224");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8EA2F:");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8EA4F:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0024");
	ASM_INLINE("MOV	BX,0x000E");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E2E1_");
	ASM_INLINE("PUSH	[SI+0x02].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[SI+0x02].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8EAA8");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,[SI+0x02].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("INC	AX");
	ASM_INLINE("OR	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8EAA8:");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EADE");
ASM_INLINE("_8EAB4:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0023");
	ASM_INLINE("MOV	BX,0x000E");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("MOV	DX,[SI+0x04].W");
	ASM_INLINE("CALL	unk_8E2E1_");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8EADE:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void unk_8EAE2()
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[DI+0x06].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JGE	_8EAFB");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8EBE3");
ASM_INLINE("_8EAFB:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[DI+0x06].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("SHL	SI,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,tuneup_table_");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("MOV	DX,0x000C");
	ASM_INLINE("MUL	DX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	AX,ES:[BX].W");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JNZ	_8EB45");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_8EBE3");
ASM_INLINE("_8EB45:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	[BX+0x04].B,AL");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("CMP	[BX+0x04].B,0x63");
	ASM_INLINE("JBE	_8EB5B");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	[BX+0x04].B,0x63");
ASM_INLINE("_8EB5B:");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("JMP	_8EB7A");
ASM_INLINE("_8EB5F:");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("CMP	CX,AX");
	ASM_INLINE("JL	_8EB7F");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("CMP	[BX].B,0x03");
	ASM_INLINE("JL	_8EB7F");
	ASM_INLINE("INC	DX");
ASM_INLINE("_8EB7A:");
	ASM_INLINE("CMP	DX,0x0008");
	ASM_INLINE("JL	_8EB5F");
ASM_INLINE("_8EB7F:");
	ASM_INLINE("CMP	DX,0x0007");
	ASM_INLINE("JL	_8EB89");
	ASM_INLINE("MOV	[DI+0x11].B,CL");
	ASM_INLINE("JMP	_8EBB3");
ASM_INLINE("_8EB89:");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("JMP	_8EBA6");
ASM_INLINE("_8EB8E:");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("ADD	SI,0x000A");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("INC	BX");
	ASM_INLINE("ADD	SI,BX");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("MOV	[SI].B,AL");
	ASM_INLINE("POP	AX");
	ASM_INLINE("DEC	AX");
ASM_INLINE("_8EBA6:");
	ASM_INLINE("CMP	AX,DX");
	ASM_INLINE("JGE	_8EB8E");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("ADD	BX,0x000A");
	ASM_INLINE("ADD	BX,DX");
	ASM_INLINE("MOV	[BX].B,CL");
ASM_INLINE("_8EBB3:");
	ASM_INLINE("MOV	CX,[DI+0x06].W");
	ASM_INLINE("JMP	_8EBD0");
ASM_INLINE("_8EBB8:");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("ADD	SI,0x0005");
	ASM_INLINE("ADD	SI,CX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("INC	AX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("MOV	[SI].B,AL");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8EBD0:");
	ASM_INLINE("CMP	CX,0x0007");
	ASM_INLINE("JL	_8EBB8");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	[BX].B,0xFF");
	ASM_INLINE("MOV	AX,0x0001");
ASM_INLINE("_8EBE3:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8EBE8(u16 a, u16 b)
{
ASM_INLINE("_8EBE8:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JNZ	_8EBF5");
	ASM_INLINE("JMP	_8EE23");
ASM_INLINE("_8EBF5:");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JNZ	_8EBFD");
	ASM_INLINE("JMP	_8EDBA");
ASM_INLINE("_8EBFD:");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JNZ	_8EC05");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EC05:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JNZ	_8EC0D");
	ASM_INLINE("JMP	_8ED2A");
ASM_INLINE("_8EC0D:");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JNZ	_8EC15");
	ASM_INLINE("JMP	_8ECA5");
ASM_INLINE("_8EC15:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JZ	_8EC1C");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EC1C:");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("DEC	[SI+0x06].W");
	ASM_INLINE("CMP	[SI+0x06].W,0x0000");
	ASM_INLINE("JGE	_8EC55");
	ASM_INLINE("MOV	[SI+0x06].W,0x0000");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EC55:");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8EC98");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("INC	AX");
	ASM_INLINE("OR	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EC98:");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8ECA5:");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("INC	[SI+0x06].W");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JNZ	_8ECEE");
	ASM_INLINE("DEC	[SI+0x06].W");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8ECEE:");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8ED1D");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("INC	AX");
	ASM_INLINE("OR	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8ED1D:");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8ED2A:");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("POP	AX");
	ASM_INLINE("CALL	unk_8DFA1_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JZ	_8ED57");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,0x8223");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8ED57:");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("CALLF	unk_8EAE2_, SEG unk_8EAE2_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JZ	_8ED89");
	ASM_INLINE("DEC	[SI+0x06].W");
	ASM_INLINE("CMP	[SI+0x06].W,0x0000");
	ASM_INLINE("JGE	_8ED70");
	ASM_INLINE("MOV	[SI+0x06].W,0x0000");
ASM_INLINE("_8ED70:");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("CALL	unk_8E897_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("CALL	unk_8EBE8_");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("JMP	_8ED9A");
ASM_INLINE("_8ED89:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,0x8223");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8ED9A:");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EDBA:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0026");
	ASM_INLINE("MOV	BX,0x000D");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E2E1_");
	ASM_INLINE("PUSH	[SI+0x06].W");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E557_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JL	_8EE17");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,[SI+0x06].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("CBW");
	ASM_INLINE("INC	AX");
	ASM_INLINE("OR	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EE17:");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EE4E");
ASM_INLINE("_8EE23:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0025");
	ASM_INLINE("MOV	BX,0x000D");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,[SI+0x08].W");
	ASM_INLINE("CALL	unk_8E2E1_");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8EE4E:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8EE52(u16 a, u16 b)
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JNZ	_8EE5F");
	ASM_INLINE("JMP	_8F00A");
ASM_INLINE("_8EE5F:");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JNZ	_8EE67");
	ASM_INLINE("JMP	_8EF52");
ASM_INLINE("_8EE67:");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JNZ	_8EE6F");
	ASM_INLINE("JMP	_8F0BF");
ASM_INLINE("_8EE6F:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JZ	_8EE86");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JNZ	_8EE7C");
	ASM_INLINE("JMP	_8F0BF");
ASM_INLINE("_8EE7C:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JNZ	_8EE83");
	ASM_INLINE("JMP	_8F0BF");
ASM_INLINE("_8EE83:");
	ASM_INLINE("JMP	_8F0BF");
ASM_INLINE("_8EE86:");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	CX,ES:[BX+0x0000].W");
	ASM_OP5(0x26,0x8B,0x8F,0x00,0x00);
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CMP	AX,CX");
	ASM_INLINE("JL	_8EED7");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("CMP	[BX+0x02].B,0x0A");
	ASM_INLINE("JNB	_8EED7");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("SUB	[BX+0x04].B,CL");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("INC	[BX+0x02].B");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("JMP	_8EF00");
ASM_INLINE("_8EED7:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CMP	AX,CX");
	ASM_INLINE("JL	_8EEF6");
	ASM_INLINE("MOV	AX,0x8221");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8EF00");
ASM_INLINE("_8EEF6:");
	ASM_INLINE("MOV	AX,0x8226");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8EF00:");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0015");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x02].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("JMP	_8F0BF");
ASM_INLINE("_8EF52:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0028");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0014");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0015");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x02].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0017");
	ASM_INLINE("MOV	BX,0x0006");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x0000].W");
	ASM_OP5(0x26,0x8B,0x87,0x00,0x00);
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x002A");
	ASM_INLINE("MOV	BX,0x0006");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DE28_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x821D");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8F0BF");
ASM_INLINE("_8F00A:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0027");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0012");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0015");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x02].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0016");
	ASM_INLINE("MOV	BX,0x0006");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x0000].W");
	ASM_OP5(0x26,0x8B,0x87,0x00,0x00);
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0029");
	ASM_INLINE("MOV	BX,0x0006");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DE28_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F0BF:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8F0C3(u16 a, u16 b)
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JNZ	_8F0D1");
	ASM_INLINE("JMP	_8F280");
ASM_INLINE("_8F0D1:");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JNZ	_8F0D9");
	ASM_INLINE("JMP	_8F1C9");
ASM_INLINE("_8F0D9:");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JNZ	_8F0E1");
	ASM_INLINE("JMP	_8F28F");
ASM_INLINE("_8F0E1:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JZ	_8F0F8");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JNZ	_8F0EE");
	ASM_INLINE("JMP	_8F28F");
ASM_INLINE("_8F0EE:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JNZ	_8F0F5");
	ASM_INLINE("JMP	_8F28F");
ASM_INLINE("_8F0F5:");
	ASM_INLINE("JMP	_8F28F");
ASM_INLINE("_8F0F8:");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	CX,ES:[BX+0x0000].W");
	ASM_OP5(0x26,0x8B,0x8F,0x00,0x00);
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	DX,0x000F");
	ASM_INLINE("MUL	DX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,ES:[BX+0x02].B");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("CMP	AL,[BX+0x02].B");
	ASM_INLINE("JNB	_8F166");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	[BX+0x04].B,CL");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("CMP	[BX+0x04].B,0x63");
	ASM_INLINE("JBE	_8F157");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	[BX+0x04].B,0x63");
ASM_INLINE("_8F157:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("DEC	[BX+0x02].B");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("JMP	_8F177");
ASM_INLINE("_8F166:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,0x8222");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F177:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0015");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x02].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("JMP	_8F28F");
ASM_INLINE("_8F1C9:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0028");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0013");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0015");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x02].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0018");
	ASM_INLINE("MOV	BX,0x0006");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x0000].W");
	ASM_OP5(0x26,0x8B,0x87,0x00,0x00);
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x002B");
	ASM_INLINE("MOV	BX,0x0006");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DE28_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x821F");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8F28F");
ASM_INLINE("_8F280:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("CALL	unk_8EE52_");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F28F:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8F294(u16 a, u16 b)
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JNZ	_8F2A1");
	ASM_INLINE("JMP	_8F459");
ASM_INLINE("_8F2A1:");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JNZ	_8F2A9");
	ASM_INLINE("JMP	_8F39C");
ASM_INLINE("_8F2A9:");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JNZ	_8F2B1");
	ASM_INLINE("JMP	_8F513");
ASM_INLINE("_8F2B1:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JZ	_8F2C8");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JNZ	_8F2BE");
	ASM_INLINE("JMP	_8F513");
ASM_INLINE("_8F2BE:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JNZ	_8F2C5");
	ASM_INLINE("JMP	_8F513");
ASM_INLINE("_8F2C5:");
	ASM_INLINE("JMP	_8F513");
ASM_INLINE("_8F2C8:");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CMP	AX,CX");
	ASM_INLINE("JL	_8F321");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("CMP	[BX+0x03].B,0x32");
	ASM_INLINE("JNB	_8F321");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("SUB	[BX+0x04].B,CL");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("ADD	[BX+0x03].B,0x05");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("JMP	_8F34A");
ASM_INLINE("_8F321:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CMP	AX,CX");
	ASM_INLINE("JL	_8F340");
	ASM_INLINE("MOV	AX,0x8221");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8F34A");
ASM_INLINE("_8F340:");
	ASM_INLINE("MOV	AX,0x8226");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F34A:");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001C");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x03].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("JMP	_8F513");
ASM_INLINE("_8F39C:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0028");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001B");
	ASM_INLINE("MOV	BX,0x0007");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001C");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x03].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001E");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x002A");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DE28_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x821E");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8F513");
ASM_INLINE("_8F459:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0027");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0019");
	ASM_INLINE("MOV	BX,0x0007");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001C");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x03].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001D");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[SI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0029");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DE28_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F513:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8F517(u16 a, u16 b)
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JNZ	_8F525");
	ASM_INLINE("JMP	_8F6E1");
ASM_INLINE("_8F525:");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JNZ	_8F52D");
	ASM_INLINE("JMP	_8F625");
ASM_INLINE("_8F52D:");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JNZ	_8F535");
	ASM_INLINE("JMP	_8F6F0");
ASM_INLINE("_8F535:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JZ	_8F54C");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JNZ	_8F542");
	ASM_INLINE("JMP	_8F6F0");
ASM_INLINE("_8F542:");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JNZ	_8F549");
	ASM_INLINE("JMP	_8F6F0");
ASM_INLINE("_8F549:");
	ASM_INLINE("JMP	_8F6F0");
ASM_INLINE("_8F54C:");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	SI,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[SI].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	DX,0x000F");
	ASM_INLINE("MUL	DX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,ES:[BX+0x03].B");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("CMP	AL,[BX+0x03].B");
	ASM_INLINE("JNB	_8F5C2");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("ADD	[BX+0x04].B,CL");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("CMP	[BX+0x04].B,0x63");
	ASM_INLINE("JBE	_8F5B2");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	[BX+0x04].B,0x63");
ASM_INLINE("_8F5B2:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("SUB	[BX+0x03].B,0x05");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("JMP	_8F5D3");
ASM_INLINE("_8F5C2:");
	ASM_INLINE("MOV	AL,0x0B");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,0x8222");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F5D3:");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x04].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001C");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x03].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("JMP	_8F6F0");
ASM_INLINE("_8F625:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0028");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001A");
	ASM_INLINE("MOV	BX,0x0007");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001C");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX+0x03].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("MOV	CX,0x0010");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DC88_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001F");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,[DI+0x12].W");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,SEG tuneup_table_");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x002B");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("MOV	CX,0x0008");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DE28_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	AX,0x8220");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8F6F0");
ASM_INLINE("_8F6E1:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("CALL	unk_8F294_");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F6F0:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8F6F5(u16 val)
{
	memfree();
	task_delete();

	switch(SAVE_DATA_START[0x07])
	{
		case 0:
		{
			task_append((task_pointer)stage_select_init, 0);
			task_delete_fade(10);
			break;
		}
		case 1:
		{
			task_append((task_pointer)m_game_init, 0);
			task_delete_fade(10);
			break;
		}
		case 2:
		case 3:
		{
			break;
		}
	}
}

static void near unk_8F743(u16 *unk)
{
/*	switch(SAVE_DATA_START[0x07])
	{
		case 0:
		{
			break;
		}
		case 1:
		{
			memfree();
			task_delete();
			task_append((task_pointer)stage_select_init, 0);
			task_delete_fade(10);
			break;
		}
		case 2:
		case 3:
		{
			break;
		}
	}*/
	stage_select_init; //Force include
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BL,[0x1E07].B");
	ASM_INLINE("CMP	BL,0x03");
	ASM_INLINE("JZ	_8F77E");
	ASM_INLINE("CMP	BL,0x02");
	ASM_INLINE("JZ	_8F77E");
	ASM_INLINE("CMP	BL,0x01");
	ASM_INLINE("JZ	_8F75D");
	ASM_INLINE("TEST	BL,BL");
	ASM_INLINE("JZ	_8F77E");
	ASM_INLINE("JMP	_8F77E");
ASM_INLINE("_8F75D:");
	ASM_INLINE("CALLF	memfree_, SEG memfree_");
	ASM_INLINE("CALLF	task_delete_, SEG task_delete_");
	ASM_INLINE("MOV	AX,stage_select_init_");
	ASM_INLINE("MOV	BX,SEG stage_select_init_");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	task_append_, SEG task_append_");
	ASM_INLINE("MOV	AX,0x000A");
	ASM_INLINE("CALLF	task_delete_fade_, SEG task_delete_fade_");
	ASM_INLINE("JMP	_8F77E");
ASM_INLINE("_8F77E:");
	ASM_INLINE("POP	CX");
}

static void near unk_8F780(u16 val, u16 val2)
{
	/*switch(val2)
	{
		case 0:
		case 1:
		{
			break;
		}
		case 2:
		{
			sereq(10);
			unk_8F6F5(val);
		}
		case 3:
		{
			break;
		}
		case 4:
		{
			unk_8DD97(34, 10, 0, 0, 1);
			put_message(0x8225, 0);
			break;
		}
		case 5:
		{
			unk_8DD97(32, 10, 0, 0, 1);
			put_message(0x8200, 0);
			break;
		}
	}*/
	
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("CMP	BX,0x0005");
	ASM_INLINE("JZ	_8F7D1");
	ASM_INLINE("CMP	BX,0x0004");
	ASM_INLINE("JZ	_8F7B1");
	ASM_INLINE("CMP	BX,0x0003");
	ASM_INLINE("JZ	_8F7EF");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JZ	_8F7A3");
	ASM_INLINE("CMP	BX,0x0001");
	ASM_INLINE("JZ	_8F7EF");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JZ	_8F7EF");
	ASM_INLINE("JMP	_8F7EF");
ASM_INLINE("_8F7A3:");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("CALL	unk_8F6F5_");
	ASM_INLINE("JMP	_8F7EF");
ASM_INLINE("_8F7B1:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0022");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x8225");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("JMP	_8F7EF");
ASM_INLINE("_8F7D1:");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0020");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("XOR	DX,DX");
	ASM_INLINE("CALL	unk_8DD97_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("MOV	AX,0x8200");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_8F7EF:");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void unk_8F7F2(struct TuneupWork *work)
{
/*	if(work->unk0 < 2)
	{
		if ((pad[0].unk8 & 0x800))
		{
			tune_func[work->unk0](work, 5);
			work->unk0--;
			if (work->unk0 < 0)
			{
				work->unk0 = 6;
			}
			tune_func[work->unk0](work, 4);
			sereq(0xc);
		}
		if ((pad[0].unk8 & 0x200))
		{
			tune_func[work->unk0](work, 5);
			work->unk0++;
			if (work->unk0 >= 7)
			{
				work->unk0 = 0;
			}
			tune_func[work->unk0](work, 4);
			sereq(0xc);
		}
		if ((pad[0].unk8 & 0x100))
		{
			tune_func[work->unk0](work, 0);
		}
		//Some weirdness with codegen here not sure how to resolve
		if ((pad[0].unk8 & 0x400))
		{
			tune_func[work->unk0](work, 1);
		}
	}
	else
	{
		if ((pad[0].unk8 & 0x800))
		{
			tune_func[work->unk0](work, 5);
			work->unk0 = 1;
			tune_func[work->unk0](work, 4);
			sereq(0xc);
		}
		if ((pad[0].unk8 & 0x200))
		{
			tune_func[work->unk0](work, 5);
			work->unk0 = 0;
			tune_func[work->unk0](work, 4);
			sereq(0xc);
		}
		if ((pad[0].unk8 & 0x100))
		{
			tune_func[work->unk0](work, 5);
			work->unk0--;
			if (work->unk0 < 0)
			{
				work->unk0 = 6;
			}
			tune_func[work->unk0](work, 4);
			sereq(0xc);
		}
		if ((pad[0].unk8 & 0x400))
		{
			tune_func[work->unk0](work, 5);
			work->unk0++;
			if (work->unk0 >= 7)
			{
				work->unk0 = 0;
			}
			tune_func[work->unk0](work, 4);
			sereq(0xc);
		}
	}
	if ((pad[0].unk6 & 4))
	{
		tune_func[work->unk0](work, 2);
	}
	if ((pad[0].unk6 & 8))
	{
		tune_func[work->unk0](work, 3);
		unk_8F743(work);
	}
	if ((pad[0].unk6 & 2))
	{
		sereq(0xc);
		unk_8F6F5(work);
	}*/
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("CMP	[DI].W,0x0002");
	ASM_INLINE("JL	_8F7FF");
	ASM_INLINE("JMP	_8F8BA");
ASM_INLINE("_8F7FF:");
	ASM_INLINE("TEST	[0x095A].W,0x0800");
	ASM_INLINE("JZ	_8F83F");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("DEC	[DI].W");
	ASM_INLINE("CMP	[DI].W,0x0000");
	ASM_INLINE("JGE	_8F825");
	ASM_INLINE("MOV	[DI].W,0x0006");
ASM_INLINE("_8F825:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8F83F:");
	ASM_INLINE("TEST	[0x095A].W,0x0200");
	ASM_INLINE("JZ	_8F87F");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("INC	[DI].W");
	ASM_INLINE("CMP	[DI].W,0x0007");
	ASM_INLINE("JL	_8F865");
	ASM_INLINE("MOV	[DI].W,0x0000");
ASM_INLINE("_8F865:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8F87F:");
	ASM_INLINE("TEST	[0x095A].W,0x0100");
	ASM_INLINE("JZ	_8F899");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
ASM_INLINE("_8F899:");
	ASM_INLINE("TEST	[0x095A].W,0x0400");
	ASM_INLINE("JNZ	_8F8A4");
	ASM_INLINE("JMP	_8F9AC");
ASM_INLINE("_8F8A4:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("JMP	_8F9AC");
ASM_INLINE("_8F8BA:");
	ASM_INLINE("TEST	[0x095A].W,0x0800");
	ASM_INLINE("JZ	_8F8F3");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	[DI].W,0x0001");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8F8F3:");
	ASM_INLINE("TEST	[0x095A].W,0x0200");
	ASM_INLINE("JZ	_8F92C");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	[DI].W,0x0000");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8F92C:");
	ASM_INLINE("TEST	[0x095A].W,0x0100");
	ASM_INLINE("JZ	_8F96C");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("DEC	[DI].W");
	ASM_INLINE("CMP	[DI].W,0x0000");
	ASM_INLINE("JGE	_8F952");
	ASM_INLINE("MOV	[DI].W,0x0006");
ASM_INLINE("_8F952:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8F96C:");
	ASM_INLINE("TEST	[0x095A].W,0x0400");
	ASM_INLINE("JZ	_8F9AC");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("INC	[DI].W");
	ASM_INLINE("CMP	[DI].W,0x0007");
	ASM_INLINE("JL	_8F992");
	ASM_INLINE("MOV	[DI].W,0x0000");
ASM_INLINE("_8F992:");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8F9AC:");
	ASM_INLINE("TEST	[0x0958].W,0x0004");
	ASM_INLINE("JZ	_8F9C7");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
ASM_INLINE("_8F9C7:");
	ASM_INLINE("TEST	[0x0958].W,0x0008");
	ASM_INLINE("JZ	_8F9E7");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0003");
	ASM_INLINE("MOV	CX,0xBAE8");
	ASM_INLINE("MOV	ES,CX");
	ASM_INLINE("MOV	SI,[DI].W");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("CALL	ES:[SI+0x0000].W");
	ASM_OP5(0x26,0xFF,0x94,0x00,0x00);
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("CALL	unk_8F743_");
ASM_INLINE("_8F9E7:");
	ASM_INLINE("TEST	[0x0958].W,0x0002");
	ASM_INLINE("JZ	_8F9FB");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("CALL	unk_8F6F5_");
ASM_INLINE("_8F9FB:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	CX");
}
