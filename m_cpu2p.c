
#include <machine.h>
#include "types.h"
#include "m_cpu2p.h"
#include "SERIAL.h"
#include "func_tbl.h"
#include "SWAN_L_C.h"
#include "SWANMAIN.h"
#include "SPRINTF.h"
#include "SYSTEM.h"
#include "SOUND_CODE.h"
#include "MEMORY.h"
#include "PAD.h"
#include "story.h"
#include "IP_MES.h"
#include "m_sub.h"
#include "PUT_TEXT.h"
#include "m_game.h"

static u8 m_cpu2p_data[] = {
	0x03, 0x02, 0xA8, 0xC0,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x05, 0x00,
};

static u8 m_cpu2p_data2[] = {
    0x02, 0x02, 0xA8, 0xC0,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
	0x05, 0x00,
};

static u8 m_cpu2p_data3[] = {
	0x04, 0x02, 0xA8, 0xC0,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x05, 0x00,
};

static u8 m_cpu2p_data4[] = {
	0x05, 0x02, 0xA8, 0xC0,
    0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
    0x05, 0x00,
};

static u8 m_cpu2p_data5[] = {
	0x06, 0x02, 0xA8, 0xC0,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x05, 0x00,
};

static u8 m_cpu2p_data6[] = {
	0x07, 0x02, 0xA8, 0xC0,
	0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x05, 0x00,
};

static u8 m_cpu2p_data7[] = {
	0x08, 0x02, 0xA8, 0xC0,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x05, 0x00
};

u8 effect_tbl[] = {
    0x30, 0x00, 0x30, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0xF9, 0xD2, 0x18, 0x00, 0x28, 0x00,
    0x10, 0x00, 0x06, 0x00, 0x00, 0x00, 0xAD, 0xD3, 0x10, 0x00, 0x20, 0x00, 0x08, 0x00, 0x0B, 0x00,
    0x00, 0x00, 0x22, 0xD4, 0x30, 0x00, 0x30, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0x60, 0xD4,
    0x20, 0x00, 0x30, 0x00, 0x10, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x67, 0xD5, 0x20, 0x00, 0x20, 0x00,
    0x08, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x2C, 0xD6, 0x18, 0x00, 0x28, 0x00, 0x00, 0x00, 0x0C, 0x00,
    0x00, 0x00, 0xB9, 0xD6, 0x20, 0x00, 0x20, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, 0x44, 0xD7,
    0x18, 0x00, 0x18, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, 0x9F, 0xD7, 0x20, 0x00, 0x20, 0x00,
    0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0xE4, 0xD7, 0x18, 0x00, 0x18, 0x00, 0x00, 0x00, 0x0A, 0x00,
    0x00, 0x00, 0x33, 0xD8, 0x18, 0x00, 0x18, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, 0x72, 0xD8,
    0x30, 0x00, 0x30, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0xDB, 0xD1,
};

static void near unk_890A8(u16 a);
static void near unk_890A9(u16 a);
static void near unk_8965C(u16 a);
static void near unk_89689(u16 a);

void m_cpu2p_init(u16 a)
{
	switch(mother_child)
	{
		case 1:
		case 2:
		{
			unk_890A8(a);
			return;
		}
		case 0: 
		{
			unk_8965C(a);
			return;
		}
	}
}

void m_cpu2p_main(u16 a)
{
	switch(mother_child)
	{
		case 1:
		case 2:
		{
			unk_890A9(a);
			return;
		}
		case 0: 
		{
			unk_89689(a);
			return;
		}
	}
}

static void near unk_890A8(u16 a)
{
}

static void near unk_890A9(u16 a)
{
	ip_r; //Force include
	put_hp_level; //Force include
	set_effect_task; //Force include
	put_message; //Force include
	sereq; //Force include
	put_rader_cousor; //Force include
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x009A");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x16].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x16].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_890EE");
	ASM_INLINE("MOV	AL,[BP-0x12].B");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x50].W,AX");
	ASM_INLINE("MOV	AL,[BP-0x12].B");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x52].W,AX");
ASM_INLINE("_890EE:");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x2C].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data2_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x2C].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_89126");
	ASM_INLINE("MOV	AL,[BP-0x28].B");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x77].W,AX");
	ASM_INLINE("MOV	AL,[BP-0x28].B");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x79].W,AX");
ASM_INLINE("_89126:");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x42].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data3_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x42].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_89176");
	ASM_INLINE("MOV	AL,[BP-0x3E].B");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x54].W,AX");
	ASM_INLINE("MOV	AL,[BP-0x3E].B");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x56].W,AX");
	ASM_INLINE("CMP	[SI+0x54].W,0x0000");
	ASM_INLINE("JG	_89169");
	ASM_INLINE("MOV	[SI+0x54].W,0x0000");
ASM_INLINE("_89169:");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("MOV	BX,[SI+0x54].W");
	ASM_INLINE("MOV	CX,[SI+0x56].W");
	ASM_INLINE("CALLF	put_hp_level_, SEG put_hp_level_");
ASM_INLINE("_89176:");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x58].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data4_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x58].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_891BF");
	ASM_INLINE("MOV	AL,[BP-0x52].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BL,[BP-0x54].B");
	ASM_INLINE("SHR	BL,1");
	ASM_INLINE("SHR	BL,1");
	ASM_INLINE("SHR	BL,1");
	ASM_INLINE("SHR	BL,1");
	ASM_INLINE("AND	BL,0x0F");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("MOV	CL,[BP-0x54].B");
	ASM_INLINE("AND	CL,0x0F");
	ASM_INLINE("XOR	CH,CH");
	ASM_INLINE("MOV	DL,[BP-0x53].B");
	ASM_INLINE("XOR	DH,DH");
	ASM_INLINE("CALLF	set_effect_task_, SEG set_effect_task_");
	ASM_INLINE("ADD	SP,0x0002");
ASM_INLINE("_891BF:");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x6E].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data5_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x6E].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_8920D");
	ASM_INLINE("MOV	[SI+0x016D].B,0x12");
	ASM_INLINE("MOV	AX,0x800A");
	ASM_INLINE("MOV	BL,[BP-0x69].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AL,[BP-0x68].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x0E].W");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
ASM_INLINE("_8920D:");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x0084].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data6_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x0084].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_89275");
	ASM_INLINE("CMP	[BP-0x80].B,0x00");
	ASM_INLINE("JZ	_89254");
	ASM_INLINE("MOV	AL,[BP-0x7F].B");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("MOV	[SI+0x0172].B,AL");
	ASM_INLINE("MOV	AL,[BP-0x7F].B");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("MOV	[SI+0x0173].B,AL");
	ASM_INLINE("MOV	AL,[BP-0x7E].B");
	ASM_INLINE("MOV	[SI+0x0174].B,AL");
	ASM_INLINE("JMP	_89275");
ASM_INLINE("_89254:");
	ASM_INLINE("MOV	AL,[BP-0x7F].B");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("SHR	AL,1");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("MOV	[SI+0x016F].B,AL");
	ASM_INLINE("MOV	AL,[BP-0x7F].B");
	ASM_INLINE("AND	AL,0x0F");
	ASM_INLINE("MOV	[SI+0x0170].B,AL");
	ASM_INLINE("MOV	AL,[BP-0x7E].B");
	ASM_INLINE("MOV	[SI+0x0171].B,AL");
ASM_INLINE("_89275:");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("LEA	DI,[BP-0x009A].B");
	ASM_INLINE("MOV	SI,m_cpu2p_data7_");
	ASM_INLINE("MOV	CX,0x0016");
	ASM_INLINE("PUSH	DS");
	ASM_INLINE("POP	ES");
	ASM_INLINE("CLD");
	ASM_INLINE("REP MOVSB");
	ASM_INLINE("LEA	AX,[BP-0x009A].B");
	ASM_INLINE("CALLF	ip_r_, SEG ip_r_");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("POP	SI");
	ASM_INLINE("JNZ	_892D3");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("JMP	_892A8");
ASM_INLINE("_89297:");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x00B4");
	ASM_INLINE("MOV	AX,CX");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	[BX].W,0x0000");
	ASM_INLINE("INC	CX");
ASM_INLINE("_892A8:");
	ASM_INLINE("CMP	CX,0x0040");
	ASM_INLINE("JL	_89297");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("JMP	_892CE");
ASM_INLINE("_892B1:");
	ASM_INLINE("XOR	DI,DI");
	ASM_INLINE("JMP	_892C8");
ASM_INLINE("_892B5:");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,DI");
	ASM_INLINE("MOV	DX,0xFFFF");
	ASM_INLINE("CALLF	put_rader_cousor_, SEG put_rader_cousor_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("INC	DI");
ASM_INLINE("_892C8:");
	ASM_INLINE("CMP	DI,0x0008");
	ASM_INLINE("JL	_892B5");
	ASM_INLINE("INC	CX");
ASM_INLINE("_892CE:");
	ASM_INLINE("CMP	CX,0x0008");
	ASM_INLINE("JL	_892B1");
ASM_INLINE("_892D3:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

extern u16 _8087;
static void near unk_892DB()
{
	_8087; //Force include, this is likely wrong but required for matching
	rand; //Force include
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0010");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DX,AX");
	ASM_INLINE("MOV	CX,BX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("LEA	BX,[BP-0x10].B");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("JMP	_892F6");
ASM_INLINE("_892F1:");
	ASM_INLINE("MOV	[BX].W,AX");
	ASM_INLINE("INC	BX");
	ASM_INLINE("INC	BX");
	ASM_INLINE("INC	AX");
ASM_INLINE("_892F6:");
	ASM_INLINE("CMP	AX,0x0008");
	ASM_INLINE("JL	_892F1");
	ASM_INLINE("XOR	CX,CX"); 
	ASM_INLINE("JMP	_8932D");
ASM_INLINE("_892FF:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("AND	DI,0x0007");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("AND	AX,0x0007");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("MOV	BX,[BP+SI-0x10].W");
	ASM_INLINE("MOV	BX,-010h[BP+SI]");
	ASM_INLINE("SHL	DI,1");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("MOV	SI,[BP+SI-0x10].W");
	ASM_INLINE("MOV	SI,-010h[BP+SI]");
	//ASM_INLINE("MOV	[BP+DI-0x10].W,SI");
	ASM_INLINE("MOV	-010h[BP+DI],SI");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("MOV	SI,AX");
	//ASM_INLINE("MOV	[BP+SI-0x10].W,BX");
	ASM_INLINE("MOV	-010h[BP+SI],BX");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8932D:");
	ASM_INLINE("CMP	CX,0x0008");
	ASM_INLINE("JL	_892FF");
	ASM_INLINE("XOR	DI,DI");
	ASM_INLINE("POP	CX");
	ASM_INLINE("JMP	_89366");
ASM_INLINE("_89337:");
	ASM_INLINE("MOV	BX,DX");
	ASM_INLINE("ADD	BX,0x0083");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("SHL	SI,1");
	//ASM_INLINE("MOV	AX,[BP+SI-0x10].W");
	ASM_INLINE("MOV	AX,-010h[BP+SI]");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,[BX].W");
	ASM_INLINE("CMP	AX,0xFFFF");
	ASM_INLINE("JZ	_89365");
	ASM_INLINE("MOV	BX,0xA711");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("CMP	CX,ES:[BX+_8087_].W"); //Probably doesn't use _8087_ but required to match for now
	ASM_INLINE("JZ	_8936E");
ASM_INLINE("_89365:");
	ASM_INLINE("INC	DI");
ASM_INLINE("_89366:");
	ASM_INLINE("CMP	DI,0x0008");
	ASM_INLINE("JL	_89337");
	ASM_INLINE("MOV	AX,0xFFFF");
ASM_INLINE("_8936E:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static void near unk_89376()
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("ADD	SI,0x0134");
	ASM_INLINE("MOV	BL,[SI+0x05].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("MOV	AL,[SI+0x01].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("SUB	BX,AX");
	ASM_INLINE("CMP	BX,0x0000");
	ASM_INLINE("JG	_89392");
	ASM_INLINE("NEG	BX");
ASM_INLINE("_89392:");
	ASM_INLINE("MOV	CL,[SI+0x06].B");
	ASM_INLINE("XOR	CH,CH");
	ASM_INLINE("MOV	AL,[SI+0x02].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("SUB	CX,AX");
	ASM_INLINE("CMP	CX,0x0000");
	ASM_INLINE("JG	_893A5");
	ASM_INLINE("NEG	CX");
ASM_INLINE("_893A5:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JGE	_8940D");
	ASM_INLINE("CMP	CX,0x0002");
	ASM_INLINE("JGE	_8940D");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("TEST	AX,0x0001");
	ASM_INLINE("JZ	_893E3");
	ASM_INLINE("MOV	AL,[SI+0x05].B");
	ASM_INLINE("CMP	AL,[SI+0x01].B");
	ASM_INLINE("JNB	_893C6");
	ASM_INLINE("DEC	[SI+0x05].B");
	ASM_INLINE("JMP	_893C9");
ASM_INLINE("_893C6:");
	ASM_INLINE("INC	[SI+0x05].B");
ASM_INLINE("_893C9:");
	ASM_INLINE("CMP	[SI+0x05].B,0xFA");
	ASM_INLINE("JBE	_893D3");
	ASM_INLINE("MOV	[SI+0x05].B,0x00");
ASM_INLINE("_893D3:");
	ASM_INLINE("CMP	[SI+0x05].B,0x07");
	ASM_INLINE("JA	_893DC");
	ASM_INLINE("JMP	_894A7");
ASM_INLINE("_893DC:");
	ASM_INLINE("MOV	[SI+0x05].B,0x07");
	ASM_INLINE("JMP	_894A7");
ASM_INLINE("_893E3:");
	ASM_INLINE("MOV	AL,[SI+0x06].B");
	ASM_INLINE("CMP	AL,[SI+0x02].B");
	ASM_INLINE("JNB	_893F0");
	ASM_INLINE("DEC	[SI+0x06].B");
	ASM_INLINE("JMP	_893F3");
ASM_INLINE("_893F0:");
	ASM_INLINE("INC	[SI+0x06].B");
ASM_INLINE("_893F3:");
	ASM_INLINE("CMP	[SI+0x06].B,0xFA");
	ASM_INLINE("JBE	_893FD");
	ASM_INLINE("MOV	[SI+0x06].B,0x00");
ASM_INLINE("_893FD:");
	ASM_INLINE("CMP	[SI+0x06].B,0x07");
	ASM_INLINE("JA	_89406");
	ASM_INLINE("JMP	_894A7");
ASM_INLINE("_89406:");
	ASM_INLINE("MOV	[SI+0x06].B,0x07");
	ASM_INLINE("JMP	_894A7");
ASM_INLINE("_8940D:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("TEST	AX,0x0001");
	ASM_INLINE("JZ	_89460");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x001E");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JZ	_89438");
	ASM_INLINE("MOV	AL,[SI+0x05].B");
	ASM_INLINE("CMP	AL,[SI+0x01].B");
	ASM_INLINE("JNB	_89433");
	ASM_INLINE("INC	[SI+0x05].B");
	ASM_INLINE("JMP	_8944A");
ASM_INLINE("_89433:");
	ASM_INLINE("DEC	[SI+0x05].B");
	ASM_INLINE("JMP	_8944A");
ASM_INLINE("_89438:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("TEST	AX,0x0001");
	ASM_INLINE("JZ	_89447");
	ASM_INLINE("INC	[SI+0x05].B");
	ASM_INLINE("JMP	_8944A");
ASM_INLINE("_89447:");
	ASM_INLINE("DEC	[SI+0x05].B");
ASM_INLINE("_8944A:");
	ASM_INLINE("CMP	[SI+0x05].B,0xFA");
	ASM_INLINE("JBE	_89454");
	ASM_INLINE("MOV	[SI+0x05].B,0x00");
ASM_INLINE("_89454:");
	ASM_INLINE("CMP	[SI+0x05].B,0x07");
	ASM_INLINE("JBE	_894A7");
	ASM_INLINE("MOV	[SI+0x05].B,0x07");
	ASM_INLINE("JMP	_894A7");
ASM_INLINE("_89460:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x001E");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JZ	_89481");
	ASM_INLINE("MOV	AL,[SI+0x06].B");
	ASM_INLINE("CMP	AL,[SI+0x02].B");
	ASM_INLINE("JNB	_8947C");
	ASM_INLINE("INC	[SI+0x06].B");
	ASM_INLINE("JMP	_89493");
ASM_INLINE("_8947C:");
	ASM_INLINE("DEC	[SI+0x06].B");
	ASM_INLINE("JMP	_89493");
ASM_INLINE("_89481:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("TEST	AX,0x0001");
	ASM_INLINE("JZ	_89490");
	ASM_INLINE("INC	[SI+0x06].B");
	ASM_INLINE("JMP	_89493");
ASM_INLINE("_89490:");
	ASM_INLINE("DEC	[SI+0x06].B");
ASM_INLINE("_89493:");
	ASM_INLINE("CMP	[SI+0x06].B,0xFA");
	ASM_INLINE("JBE	_8949D");
	ASM_INLINE("MOV	[SI+0x06].B,0x00");
ASM_INLINE("_8949D:");
	ASM_INLINE("CMP	[SI+0x06].B,0x07");
	ASM_INLINE("JBE	_894A7");
	ASM_INLINE("MOV	[SI+0x06].B,0x07");
ASM_INLINE("_894A7:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_894AB()
{
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("ADD	SI,0x0134");
	ASM_INLINE("ADD	DI,0x0045");
	ASM_INLINE("MOV	BL,[SI+0x05].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("SUB	BX,[DI+0x0B].W");
	ASM_INLINE("CMP	BX,0x0000");
	ASM_INLINE("JG	_894C8");
	ASM_INLINE("NEG	BX");
ASM_INLINE("_894C8:");
	ASM_INLINE("MOV	AL,[SI+0x06].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("SUB	AX,[DI+0x0D].W");
	ASM_INLINE("CMP	AX,0x0000");
	ASM_INLINE("JG	_894D7");
	ASM_INLINE("NEG	AX");
ASM_INLINE("_894D7:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JGE	_894ED");
	ASM_INLINE("CMP	AX,0x0002");
	ASM_INLINE("JGE	_894ED");
	ASM_INLINE("MOV	AX,[DI+0x0B].W");
	ASM_INLINE("MOV	[SI+0x01].B,AL");
	ASM_INLINE("MOV	AX,[DI+0x0D].W");
	ASM_INLINE("MOV	[SI+0x02].B,AL");
ASM_INLINE("_894ED:");
	ASM_INLINE("CMP	[SI+0x01].B,0xFF");
	ASM_INLINE("JNZ	_89509");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("AND	AX,0x0007");
	ASM_INLINE("MOV	[SI+0x01].B,AL");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("AND	AX,0x0007");
	ASM_INLINE("MOV	[SI+0x02].B,AL");
ASM_INLINE("_89509:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x001E");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JZ	_89524");
	ASM_INLINE("MOV	AX,[DI+0x0B].W");
	ASM_INLINE("MOV	[SI+0x01].B,AL");
	ASM_INLINE("MOV	AX,[DI+0x0D].W");
	ASM_INLINE("MOV	[SI+0x02].B,AL");
ASM_INLINE("_89524:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("SUB	DX,0x0002");
	ASM_INLINE("ADD	[SI+0x01].B,DL");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("SUB	DX,0x0002");
	ASM_INLINE("ADD	[SI+0x02].B,DL");
	ASM_INLINE("CMP	[SI+0x01].B,0xFA");
	ASM_INLINE("JBE	_89550");
	ASM_INLINE("MOV	[SI+0x01].B,0x00");
ASM_INLINE("_89550:");
	ASM_INLINE("CMP	[SI+0x01].B,0x07");
	ASM_INLINE("JBE	_8955A");
	ASM_INLINE("MOV	[SI+0x01].B,0x07");
ASM_INLINE("_8955A:");
	ASM_INLINE("CMP	[SI+0x02].B,0xFA");
	ASM_INLINE("JBE	_89564");
	ASM_INLINE("MOV	[SI+0x02].B,0x00");
ASM_INLINE("_89564:");
	ASM_INLINE("CMP	[SI+0x02].B,0x07");
	ASM_INLINE("JBE	_8956E");
	ASM_INLINE("MOV	[SI+0x02].B,0x07");
ASM_INLINE("_8956E:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
}

static void near unk_89572()
{
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("MOV	SI,DI");
	ASM_INLINE("ADD	SI,0x0134");
	ASM_INLINE("ADD	DI,0x0045");
	ASM_INLINE("MOV	BL,[SI+0x05].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("SUB	BX,[DI+0x0B].W");
	ASM_INLINE("CMP	BX,0x0000");
	ASM_INLINE("JG	_8958F");
	ASM_INLINE("NEG	BX");
ASM_INLINE("_8958F:");
	ASM_INLINE("MOV	AL,[SI+0x06].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("SUB	AX,[DI+0x0D].W");
	ASM_INLINE("CMP	AX,0x0000");
	ASM_INLINE("JG	_8959E");
	ASM_INLINE("NEG	AX");
ASM_INLINE("_8959E:");
	ASM_INLINE("CMP	BX,0x0002");
	ASM_INLINE("JGE	_895B6");
	ASM_INLINE("CMP	AX,0x0002");
	ASM_INLINE("JGE	_895B6");
	ASM_INLINE("MOV	AX,[DI+0x0B].W");
	ASM_INLINE("MOV	[SI+0x03].B,AL");
	ASM_INLINE("MOV	AX,[DI+0x0D].W");
	ASM_INLINE("MOV	[SI+0x04].B,AL");
	ASM_INLINE("JMP	_895C6");
ASM_INLINE("_895B6:");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("MOV	AL,[SI+0x01].B");
	ASM_INLINE("MOV	[BX+0x03].B,AL");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("MOV	AL,[BX+0x02].B");
	ASM_INLINE("MOV	[SI+0x04].B,AL");
ASM_INLINE("_895C6:");
	ASM_INLINE("CMP	[SI+0x03].B,0xFF");
	ASM_INLINE("JZ	_895DB");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0032");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JNZ	_895F1");
ASM_INLINE("_895DB:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("AND	AX,0x0007");
	ASM_INLINE("MOV	[SI+0x03].B,AL");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("AND	AX,0x0007");
	ASM_INLINE("MOV	[SI+0x04].B,AL");
ASM_INLINE("_895F1:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x001E");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JZ	_8960E");
	ASM_INLINE("MOV	AX,[DI+0x0B].W");
	ASM_INLINE("MOV	[SI+0x01].B,AL");
	ASM_INLINE("MOV	AX,[DI+0x0D].W");
	ASM_INLINE("MOV	[SI+0x02].B,AL");
	ASM_INLINE("JMP	_89630");
ASM_INLINE("_8960E:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("SUB	DX,0x0002");
	ASM_INLINE("ADD	[SI+0x03].B,DL");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0005");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("SUB	DX,0x0002");
	ASM_INLINE("ADD	[SI+0x04].B,DL");
ASM_INLINE("_89630:");
	ASM_INLINE("CMP	[SI+0x03].B,0xFA");
	ASM_INLINE("JBE	_8963A");
	ASM_INLINE("MOV	[SI+0x03].B,0x00");
ASM_INLINE("_8963A:");
	ASM_INLINE("CMP	[SI+0x03].B,0x07");
	ASM_INLINE("JBE	_89644");
	ASM_INLINE("MOV	[SI+0x03].B,0x07");
ASM_INLINE("_89644:");
	ASM_INLINE("CMP	[SI+0x04].B,0xFA");
	ASM_INLINE("JBE	_8964E");
	ASM_INLINE("MOV	[SI+0x04].B,0x00");
ASM_INLINE("_8964E:");
	ASM_INLINE("CMP	[SI+0x04].B,0x07");
	ASM_INLINE("JBE	_89658");
	ASM_INLINE("MOV	[SI+0x04].B,0x07");
ASM_INLINE("_89658:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
}

static void near unk_8965C(u16 a)
{
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("ADD	BX,0x0134");
	ASM_INLINE("ADD	SI,0x006C");
	ASM_INLINE("MOV	[BX].B,0x00");
	ASM_INLINE("MOV	[BX+0x01].B,0xFF");
	ASM_INLINE("MOV	[BX+0x02].B,0xFF");
	ASM_INLINE("MOV	[BX+0x03].B,0xFF");
	ASM_INLINE("MOV	[BX+0x04].B,0xFF");
	ASM_INLINE("MOV	AX,[SI+0x0B].W");
	ASM_INLINE("MOV	[BX+0x05].B,AL");
	ASM_INLINE("MOV	AX,[SI+0x0D].W");
	ASM_INLINE("MOV	[BX+0x06].B,AL");
	ASM_INLINE("POP	SI");
}

static void near unk_89689(u16 a)
{
	aulist; //Force include
	get_lange_test; //Force include
	put_atack_hit_check; //Force include
	put_search_hit_check; //Force include
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0012");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	[BP-0x02].W,AX");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("ADD	AX,0x0134");
	ASM_INLINE("MOV	[BP-0x04].W,AX");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("ADD	AX,0x0045");
	ASM_INLINE("MOV	[BP-0x06].W,AX");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("ADD	AX,0x006C");
	ASM_INLINE("MOV	[BP-0x08].W,AX");
	ASM_INLINE("MOV	[BP-0x0A].W,0x0020");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("CMP	[BX+0x04].W,0x0005");
	ASM_INLINE("JZ	_896C1");
	ASM_INLINE("JMP	_89AFE");
ASM_INLINE("_896C1:");
	ASM_INLINE("MOV	AX,SEG aulist_");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	AX,[SI+0x09].W");
	ASM_INLINE("MOV	CX,0x000F");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AL,ES:[BX+0x0E].B");
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("ADD	CX,DX");
	ASM_INLINE("SUB	CX,0x0005");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("CMP	CX,[BX+0x13].W");
	ASM_INLINE("JLE	_896F8");
	ASM_INLINE("JMP	_89AFE");
ASM_INLINE("_896F8:");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JBE	_89704");
	ASM_INLINE("MOV	AL,0x01");
	ASM_INLINE("JMP	_89706");
ASM_INLINE("_89704:");
	ASM_INLINE("XOR	AL,AL");
ASM_INLINE("_89706:");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("SUB	[BX].B,AL");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("CMP	[BX+0x04].W,0x0005");
	ASM_INLINE("JGE	_89717");
	ASM_INLINE("JMP	_897A1");
ASM_INLINE("_89717:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JNZ	_897A1");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALL	unk_892DB_");
	ASM_INLINE("MOV	[BP-0x0C].W,AX");
	ASM_INLINE("CMP	[BP-0x0C].W,-1");
	ASM_INLINE("JZ	_897A1");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	AX,[SI+0x13].W");
	ASM_INLINE("CMP	AX,ES:[BX+0x02].W");
	ASM_INLINE("JL	_897A1");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("CALL	unk_89376_");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	AL,[BX+0x05].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x0B].W,AX");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	AL,[BX+0x06].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	[SI+0x0D].W,AX");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("MOV	[BX+0x04].W,0x0000");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("SUB	[BX+0x13].W,AX");
ASM_INLINE("_897A1:");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("CMP	[BX+0x04].W,0x0005");
	ASM_INLINE("JGE	_897AD");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_897AD:");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("MOV	AX,[BX+0x0B].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("SUB	AX,[BX+0x0B].W");
	ASM_INLINE("MOV	[BP-0x0E].W,AX");
	ASM_INLINE("CMP	[BP-0x0E].W,0x0000");
	ASM_INLINE("JLE	_897C7");
	ASM_INLINE("MOV	AX,[BP-0x0E].W");
	ASM_INLINE("JMP	_897CC");
ASM_INLINE("_897C7:");
	ASM_INLINE("MOV	AX,[BP-0x0E].W");
	ASM_INLINE("NEG	AX");
ASM_INLINE("_897CC:");
	ASM_INLINE("MOV	[BP-0x0E].W,AX");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("MOV	AX,[BX+0x0D].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("SUB	AX,[BX+0x0D].W");
	ASM_INLINE("MOV	[BP-0x10].W,AX");
	ASM_INLINE("CMP	[BP-0x10].W,0x0000");
	ASM_INLINE("JLE	_897E9");
	ASM_INLINE("MOV	AX,[BP-0x10].W");
	ASM_INLINE("JMP	_897EE");
ASM_INLINE("_897E9:");
	ASM_INLINE("MOV	AX,[BP-0x10].W");
	ASM_INLINE("NEG	AX");
ASM_INLINE("_897EE:");
	ASM_INLINE("MOV	[BP-0x10].W,AX");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0004");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JZ	_89812");
	ASM_INLINE("CMP	[BP-0x0E].W,0x0004");
	ASM_INLINE("JL	_89809");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_89809:");
	ASM_INLINE("CMP	[BP-0x10].W,0x0004");
	ASM_INLINE("JL	_89812");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_89812:");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("CMP	[BX+0x04].W,0x0000");
	ASM_INLINE("JNZ	_8981E");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_8981E:");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("CALL	unk_892DB_");
	ASM_INLINE("MOV	[BP-0x0C].W,AX");
	ASM_INLINE("CMP	[BP-0x0C].W,-1");
	ASM_INLINE("JNZ	_89833");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_89833:");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	AX,[SI+0x13].W");
	ASM_INLINE("CMP	AX,ES:[BX+0x02].W");
	ASM_INLINE("JGE	_89857");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_89857:");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("CALL	unk_89572_");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x04].W");
	ASM_INLINE("AND	AX,0x00FF");
	ASM_INLINE("MOV	[BP-0x12].W,AX");
	ASM_INLINE("PUSH	[BP-0x12].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("MOV	AX,[BX+0x0B].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("MOV	BX,[BX+0x0D].W");
	ASM_INLINE("MOV	SI,[BP-0x04].W");
	ASM_INLINE("MOV	CL,[SI+0x03].B");
	ASM_INLINE("XOR	CH,CH");
	ASM_INLINE("MOV	SI,[BP-0x04].W");
	ASM_INLINE("MOV	DL,[SI+0x04].B");
	ASM_INLINE("XOR	DH,DH");
	ASM_INLINE("CALLF	get_lange_test_, SEG get_lange_test_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JZ	_898AA");
	ASM_INLINE("JMP	_89953");
ASM_INLINE("_898AA:");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("PUSH	[BX+0x0D].W");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("PUSH	[BX+0x0B].W");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	BL,[BX+0x03].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("MOV	SI,[BP-0x04].W");
	ASM_INLINE("MOV	CL,[SI+0x04].B");
	ASM_INLINE("XOR	CH,CH");
	ASM_INLINE("MOV	DX,[BP-0x0C].W");
	ASM_INLINE("CALLF	put_atack_hit_check_, SEG put_atack_hit_check_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	[BP-0x0A].W,AX");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("MOV	[BX+0x04].W,0x0000");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("SUB	[BX+0x13].W,AX");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x06].W");
	ASM_INLINE("AND	AX,0x00FF");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	BL,[BX+0x03].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("MOV	SI,[BP-0x04].W");
	ASM_INLINE("MOV	CL,[SI+0x04].B");
	ASM_INLINE("XOR	CH,CH");
	ASM_INLINE("MOV	DX,0xA711");
	ASM_INLINE("MOV	ES,DX");
	ASM_INLINE("MOV	SI,0x0000");
	ASM_INLINE("MOV	DX,[BP-0x0C].W");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("SHL	DX,1");
	ASM_INLINE("ADD	SI,DX");
	ASM_INLINE("MOV	DX,ES:[SI+0x0C].W");
	ASM_INLINE("AND	DX,0x00FF");
	ASM_INLINE("CALLF	set_effect_task_, SEG set_effect_task_");
	ASM_INLINE("ADD	SP,0x0002");
ASM_INLINE("_89953:");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("CMP	[BX+0x04].W,0x0005");
	ASM_INLINE("JGE	_8995F");
	ASM_INLINE("JMP	_89A27");
ASM_INLINE("_8995F:");
	ASM_INLINE("CALLF	rand_, SEG rand_");
	ASM_INLINE("MOV	BX,0x0002");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("TEST	DX,DX");
	ASM_INLINE("JZ	_89971");
	ASM_INLINE("JMP	_89A27");
ASM_INLINE("_89971:");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("CMP	[BX].B,0x00");
	ASM_INLINE("JZ	_8997C");
	ASM_INLINE("JMP	_89A27");
ASM_INLINE("_8997C:");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALL	unk_892DB_");
	ASM_INLINE("MOV	[BP-0x0C].W,AX");
	ASM_INLINE("CMP	[BP-0x0C].W,-1");
	ASM_INLINE("JNZ	_89991");
	ASM_INLINE("JMP	_89A27");
ASM_INLINE("_89991:");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	AX,[SI+0x13].W");
	ASM_INLINE("CMP	AX,ES:[BX+0x02].W");
	ASM_INLINE("JL	_89A27");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("CALL	unk_894AB_");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x04].W");
	ASM_INLINE("AND	AX,0x00FF");
	ASM_INLINE("MOV	[BP-0x12].W,AX");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("PUSH	[BX+0x0D].W");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("PUSH	[BX+0x0B].W");
	ASM_INLINE("MOV	AX,[BP-0x02].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("MOV	BX,[BX+0x0B].W");
	ASM_INLINE("MOV	SI,[BP-0x08].W");
	ASM_INLINE("MOV	CX,[SI+0x0D].W");
	ASM_INLINE("MOV	DX,[BP-0x0C].W");
	ASM_INLINE("CALLF	put_search_hit_check_, SEG put_search_hit_check_");
	ASM_INLINE("ADD	SP,0x0004");
	ASM_INLINE("MOV	[BP-0x0A].W,AX");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("MOV	[BX+0x04].W,0x0000");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x02].W");
	ASM_INLINE("MOV	BX,[BP-0x08].W");
	ASM_INLINE("SUB	[BX+0x13].W,AX");
ASM_INLINE("_89A27:");
	ASM_INLINE("TEST	[BP-0x0A].W,0x0020");
	ASM_INLINE("JZ	_89A31");
	ASM_INLINE("JMP	_89AFE");
ASM_INLINE("_89A31:");
	ASM_INLINE("TEST	[BP-0x0A].W,0x0010");
	ASM_INLINE("JZ	_89A40");
	ASM_INLINE("MOV	BX,[BP-0x02].W");
	ASM_INLINE("MOV	[BX+0x0171].B,0x48");
ASM_INLINE("_89A40:");
	ASM_INLINE("TEST	[BP-0x0A].W,0x0008");
	ASM_INLINE("JZ	_89A47");
ASM_INLINE("_89A47:");
	ASM_INLINE("TEST	[BP-0x0A].W,0x0004");
	ASM_INLINE("JZ	_89AC0");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	[BX].B,0x32");
	ASM_INLINE("MOV	AX,0xA711");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,[BP-0x0C].W");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("SHL	AX,1");
	ASM_INLINE("ADD	BX,AX");
	ASM_INLINE("MOV	AX,ES:[BX+0x0A].W");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("SUB	[BX+0x0F].W,AX");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("CMP	[BX+0x0F].W,0x0000");
	ASM_INLINE("JG	_89A84");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("MOV	[BX+0x0F].W,0x0000");
ASM_INLINE("_89A84:");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("MOV	BX,[BX+0x0F].W");
	ASM_INLINE("MOV	SI,[BP-0x06].W");
	ASM_INLINE("MOV	CX,[SI+0x11].W");
	ASM_INLINE("CALLF	put_hp_level_, SEG put_hp_level_");
	ASM_INLINE("MOV	BX,[BP-0x02].W");
	ASM_INLINE("MOV	[BX+0x016D].B,0x12");
	ASM_INLINE("MOV	AX,0x800A");
	ASM_INLINE("MOV	BX,0xA711");
	ASM_INLINE("MOV	ES,BX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	CX,[BP-0x0C].W");
	ASM_INLINE("SHL	CX,1");
	ASM_INLINE("SHL	CX,1");
	ASM_INLINE("SHL	CX,1");
	ASM_INLINE("SHL	CX,1");
	ASM_INLINE("ADD	BX,CX");
	ASM_INLINE("MOV	BX,ES:[BX+0x0A].W");
	ASM_INLINE("CALLF	put_message_, SEG put_message_");
ASM_INLINE("_89AC0:");
	ASM_INLINE("TEST	[BP-0x0A].W,0x0002");
	ASM_INLINE("JZ	_89ACD");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	[BX].B,0x32");
ASM_INLINE("_89ACD:");
	ASM_INLINE("TEST	[BP-0x0A].W,0x0001");
	ASM_INLINE("JZ	_89AF2");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	[BX].B,0x28");
	ASM_INLINE("MOV	SI,[BP-0x04].W");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("MOV	AX,[BX+0x0B].W");
	ASM_INLINE("MOV	[SI+0x01].B,AL");
	ASM_INLINE("MOV	SI,[BP-0x04].W");
	ASM_INLINE("MOV	BX,[BP-0x06].W");
	ASM_INLINE("MOV	AX,[BX+0x0D].W");
	ASM_INLINE("MOV	[SI+0x02].B,AL");
ASM_INLINE("_89AF2:");
	ASM_INLINE("CMP	[BP-0x0A].W,0x0000");
	ASM_INLINE("JNZ	_89AFE");
	ASM_INLINE("MOV	BX,[BP-0x04].W");
	ASM_INLINE("MOV	[BX].B,0x0A");
ASM_INLINE("_89AFE:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}
