
#include <machine.h>
#include "types.h"
#include "stagesel.h"
#include "SWAN_L_C.h"
#include "SWANMAIN.h"
#include "MEMORY.h"
#include "PAD.h"
#include "SPRINTF.h"
#include "SYSTEM.h"
#include "flash.h"
#include "story.h"
#include "unisel.h"
#include "tuneup.h"
#include "SOUND_CODE.h"

static void near unk_8CFD3()
{
	font_put2XY; //Force include
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AL,[0x1E07].B");
	ASM_INLINE("CMP	AL,0x03");
	ASM_INLINE("JZ	_8D03A");
	ASM_INLINE("CMP	AL,0x02");
	ASM_INLINE("JZ	_8D03A");
	ASM_INLINE("CMP	AL,0x01");
	ASM_INLINE("JZ	_8D012");
	ASM_INLINE("TEST	AL,AL");
	ASM_INLINE("JNZ	_8D03A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0007");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("MOV	BX,0x000B");
	ASM_INLINE("MOV	CX,0x000A");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("JMP	_8D03A");
ASM_INLINE("_8D012:");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0007");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("MOV	BX,0x000C");
	ASM_INLINE("MOV	CX,0x000A");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
ASM_INLINE("_8D03A:");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void near unk_8D03D()
{
	bmp_print; //Force include
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0014");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("TEST	BX,BX");
	ASM_INLINE("JNZ	_8D050");
	ASM_INLINE("JMP	_8D14B");
ASM_INLINE("_8D050:");
	ASM_INLINE("LEA	DI,[BP-0x10].B");
	ASM_INLINE("MOV	AX,0xA79D");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("ADD	BX,0x1E3C");
	ASM_INLINE("CMP	[BX+0x01].B,0x00");
	ASM_INLINE("JZ	_8D073");
	ASM_INLINE("MOV	BX,0x0010");
	ASM_INLINE("JMP	_8D075");
ASM_INLINE("_8D073:");
	ASM_INLINE("XOR	BX,BX");
ASM_INLINE("_8D075:");
	ASM_INLINE("ADD	BX,[SI].W");
	//ASM_INLINE("MOV	AL,ES:[BX+0x000A].B");
	ASM_OP5(0x26,0x8A,0x87,0x0A,0x00);
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x000F");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SUB	BX,0x000F");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x0004].B");
	ASM_OP5(0x26,0x8A,0x87,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,0xA79C");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	CX,ES:[BX+0x0002].W");
	ASM_OP5(0x26,0x8B,0x8F,0x02,0x00);
	//ASM_INLINE("MOV	AX,ES:[BX+0x0004].W");
	ASM_OP5(0x26,0x8B,0x87,0x04,0x00);
	ASM_INLINE("MOV	[BP-0x14].W,CX");
	ASM_INLINE("MOV	[BP-0x12].W,AX");
ASM_INLINE("_8D0AE:");
	ASM_INLINE("INC	[BP-0x14].W");
	ASM_INLINE("LES	BX,[BP-0x14]");
	ASM_INLINE("DEC	BX");
	ASM_INLINE("MOV	AL,ES:[BX].B");
	ASM_INLINE("MOV	[DI].B,AL");
	ASM_INLINE("INC	DI");
	ASM_INLINE("TEST	AL,AL");
	ASM_INLINE("JNZ	_8D0AE");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0078");
	ASM_INLINE("MOV	BX,0x0020");
	ASM_INLINE("LEA	CX,[BP-0x10].B");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	bmp_print_, SEG bmp_print_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("LEA	DI,[BP-0x10].B");
	ASM_INLINE("MOV	AX,0xA79D");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("ADD	BX,0x1E3C");
	ASM_INLINE("CMP	[BX+0x01].B,0x00");
	ASM_INLINE("JZ	_8D0F9");
	ASM_INLINE("MOV	BX,0x0010");
	ASM_INLINE("JMP	_8D0FB");
ASM_INLINE("_8D0F9:");
	ASM_INLINE("XOR	BX,BX");
ASM_INLINE("_8D0FB:");
	ASM_INLINE("ADD	BX,[SI].W");
	//ASM_INLINE("MOV	BL,ES:[BX+0x000A].B");
	ASM_OP5(0x26,0x8A,0x9F,0x0A,0x00);
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SUB	BX,0x0004");
	ASM_INLINE("MOV	AX,0xA78E");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	CX,ES:[BX+0x000A].W");
	ASM_OP5(0x26,0x8B,0x8F,0x0A,0x00);
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	[BP-0x14].W,CX");
	ASM_INLINE("MOV	[BP-0x12].W,AX");
ASM_INLINE("_8D120:");
	ASM_INLINE("INC	[BP-0x14].W");
	ASM_INLINE("LES	BX,[BP-0x14]");
	ASM_INLINE("DEC	BX");
	ASM_INLINE("MOV	AL,ES:[BX].B");
	ASM_INLINE("MOV	[DI].B,AL");
	ASM_INLINE("INC	DI");
	ASM_INLINE("TEST	AL,AL");
	ASM_INLINE("JNZ	_8D120");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0078");
	ASM_INLINE("MOV	BX,0x0030");
	ASM_INLINE("LEA	CX,[BP-0x10].B");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	bmp_print_, SEG bmp_print_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("JMP	_8D20B");
ASM_INLINE("_8D14B:");
	ASM_INLINE("LEA	BX,[BP-0x10].B");
	ASM_INLINE("MOV	AX,0xA751");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	CX,0x001D");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("MOV	AL,[SI+0x1E3C].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	CX,0x000F");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("MOV	SI,AX");
	//ASM_INLINE("MOV	AL,ES:[SI+0x0004].B");
	ASM_OP5(0x26,0x8A,0x84,0x04,0x00);
	ASM_INLINE("CBW");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("SHL	SI,1");
	ASM_INLINE("SHL	SI,1");
	ASM_INLINE("MOV	AX,0xA79C");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	CX,ES:[SI+0x0002].W");
	ASM_OP5(0x26,0x8B,0x8C,0x02,0x00);
	//ASM_INLINE("MOV	AX,ES:[SI+0x0004].W");
	ASM_OP5(0x26,0x8B,0x84,0x04,0x00);
	ASM_INLINE("MOV	[BP-0x14].W,CX");
	ASM_INLINE("MOV	[BP-0x12].W,AX");
ASM_INLINE("_8D18D:");
	ASM_INLINE("INC	[BP-0x14].W");
	ASM_INLINE("LES	SI,[BP-0x14]");
	ASM_INLINE("DEC	SI");
	ASM_INLINE("MOV	AL,ES:[SI].B");
	ASM_INLINE("MOV	[BX].B,AL");
	ASM_INLINE("INC	BX");
	ASM_INLINE("TEST	AL,AL");
	ASM_INLINE("JNZ	_8D18D");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0030");
	ASM_INLINE("MOV	BX,0x0020");
	ASM_INLINE("LEA	CX,[BP-0x10].B");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	bmp_print_, SEG bmp_print_");
	ASM_INLINE("ADD	SP,0x0002");
	ASM_INLINE("LEA	SI,[BP-0x10].B");
	ASM_INLINE("MOV	AX,0xA78E");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("MOV	BL,[BX+0x1E3C].B");
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	//ASM_INLINE("MOV	CX,ES:[BX+0x000A].W");
	ASM_OP5(0x26,0x8B,0x8F,0x0A,0x00);
	//ASM_INLINE("MOV	AX,ES:[BX+0x000C].W");
	ASM_OP5(0x26,0x8B,0x87,0x0C,0x00);
	ASM_INLINE("MOV	[BP-0x14].W,CX");
	ASM_INLINE("MOV	[BP-0x12].W,AX");
ASM_INLINE("_8D1E3:");
	ASM_INLINE("INC	[BP-0x14].W");
	ASM_INLINE("LES	BX,[BP-0x14]");
	ASM_INLINE("DEC	BX");
	ASM_INLINE("MOV	AL,ES:[BX].B");
	ASM_INLINE("MOV	[SI].B,AL");
	ASM_INLINE("INC	SI");
	ASM_INLINE("TEST	AL,AL");
	ASM_INLINE("JNZ	_8D1E3");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0030");
	ASM_INLINE("MOV	BX,0x0030");
	ASM_INLINE("LEA	CX,[BP-0x10].B");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	bmp_print_, SEG bmp_print_");
	ASM_INLINE("ADD	SP,0x0002");
ASM_INLINE("_8D20B:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static void unk_8D213()
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("MOV	CX,BX");
	ASM_INLINE("TEST	CX,CX");
	ASM_INLINE("JZ	_8D24C");
	ASM_INLINE("MOV	AX,0xA79D");
	ASM_INLINE("MOV	ES,AX");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("ADD	BX,0x1E3C");
	ASM_INLINE("CMP	[BX+0x01].B,0x00");
	ASM_INLINE("JZ	_8D23E");
	ASM_INLINE("MOV	BX,0x0010");
	ASM_INLINE("JMP	_8D240");
ASM_INLINE("_8D23E:");
	ASM_INLINE("XOR	BX,BX");
ASM_INLINE("_8D240:");
	ASM_INLINE("ADD	BX,[SI].W");
	//ASM_INLINE("MOV	BL,ES:[BX+0x000A].B");
	ASM_OP5(0x26,0x8A,0x9F,0x0A,0x00);
	ASM_INLINE("XOR	BH,BH");
	ASM_INLINE("DEC	BX");
	ASM_INLINE("JMP	_8D25E");
ASM_INLINE("_8D24C:");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("MOV	BL,[BX+0x1E3C].B");
	ASM_INLINE("XOR	BH,BH");
ASM_INLINE("_8D25E:");
	ASM_INLINE("MOV	AX,BX");
	ASM_INLINE("MOV	SI,0x0014");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	SI");
	ASM_INLINE("CMP	AX,0x0003");
	ASM_INLINE("JNZ	_8D26E");
	ASM_INLINE("JMP	_8D310");
ASM_INLINE("_8D26E:");
	ASM_INLINE("CMP	AX,0x0002");
	ASM_INLINE("JZ	_8D2E0");
	ASM_INLINE("CMP	AX,0x0001");
	ASM_INLINE("JZ	_8D2AE");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JZ	_8D27F");
	ASM_INLINE("JMP	_8D310");
ASM_INLINE("_8D27F:");
	ASM_INLINE("MOV	DX,0x0000");
	ASM_INLINE("MOV	AX,0xB279");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0003");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0016");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("INC	AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,BX");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("MOV	CX,0x0004");
	ASM_INLINE("MOV	DX,0x0004");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("JMP	_8D310");
ASM_INLINE("_8D2AE:");
	ASM_INLINE("MOV	DX,0x0000");
	ASM_INLINE("MOV	AX,0xB494");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0003");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0016");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("INC	AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("SUB	BX,0x0014");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,BX");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("MOV	CX,0x0004");
	ASM_INLINE("MOV	DX,0x0004");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("JMP	_8D310");
ASM_INLINE("_8D2E0:");
	ASM_INLINE("MOV	DX,0x0000");
	ASM_INLINE("MOV	AX,0xB6AB");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0003");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0016");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("INC	AX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("SUB	BX,0x0028");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("SHL	BX,1");
	ASM_INLINE("MOV	AX,BX");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("MOV	CX,0x0004");
	ASM_INLINE("MOV	DX,0x0004");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
ASM_INLINE("_8D310:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void unk_8D314()
{
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0002");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,BX");
	ASM_INLINE("MOV	SI,CX");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("INC	AX");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("MOV	CX,AX");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("INC	AX");
	ASM_INLINE("MOV	BX,0x000A");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0008");
	ASM_INLINE("CWD");
	ASM_INLINE("IDIV	BX");
	ASM_INLINE("MOV	[BP-0x02].W,DX");
	ASM_INLINE("CMP	DI,0x0008");
	ASM_INLINE("POP	DX");
	ASM_INLINE("JL	_8D34B");
	ASM_INLINE("JMP	_8D550");
ASM_INLINE("_8D34B:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0002");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0004");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("TEST	CX,CX");
	ASM_INLINE("JZ	_8D3DD");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("JMP	_8D40A");
ASM_INLINE("_8D3DD:");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
ASM_INLINE("_8D40A:");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0007");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0008");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0008");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("JMP	_8D4CA");
ASM_INLINE("_8D498:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0010");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8D4CA:");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("ADD	BX,0x1E3C");
	ASM_INLINE("ADD	BX,0x000D");
	ASM_INLINE("ADD	BX,DI");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CMP	CX,AX");
	ASM_INLINE("JL	_8D498");
	ASM_INLINE("JMP	_8D51B");
ASM_INLINE("_8D4E9:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0011");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8D51B:");
	ASM_INLINE("CMP	CX,0x0004");
	ASM_INLINE("JL	_8D4E9");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x000D");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("JMP	_8D725");
ASM_INLINE("_8D550:");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x000E");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x000F");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0004");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("TEST	CX,CX");
	ASM_INLINE("JZ	_8D5E2");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0013");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("JMP	_8D60F");
ASM_INLINE("_8D5E2:");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0013");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
ASM_INLINE("_8D60F:");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("POP	DX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0014");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0006");
	ASM_INLINE("ADD	AX,DX");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0015");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("JMP	_8D6A2");
ASM_INLINE("_8D670:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0016");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0010");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8D6A2:");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("ADD	BX,0x1E3C");
	ASM_INLINE("ADD	BX,0x000D");
	ASM_INLINE("ADD	BX,DI");
	ASM_INLINE("MOV	AL,[BX].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CMP	CX,AX");
	ASM_INLINE("JL	_8D670");
	ASM_INLINE("JMP	_8D6F3");
ASM_INLINE("_8D6C1:");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0016");
	ASM_INLINE("ADD	AX,CX");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0011");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
	ASM_INLINE("POP	CX");
	ASM_INLINE("INC	CX");
ASM_INLINE("_8D6F3:");
	ASM_INLINE("CMP	CX,0x0004");
	ASM_INLINE("JL	_8D6C1");
	ASM_INLINE("MOV	BX,0x0000");
	ASM_INLINE("MOV	AX,0xBA51");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("PUSH	BX");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0009");
	ASM_INLINE("ADD	AX,[BP-0x02].W");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x001A");
	ASM_INLINE("PUSH	AX");
	ASM_INLINE("MOV	AX,0x0005");
	ASM_INLINE("MOV	BX,0x0009");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("MOV	DX,0x0001");
	ASM_INLINE("CALLF	font_put2XY_, SEG font_put2XY_");
	ASM_INLINE("ADD	SP,0x000A");
ASM_INLINE("_8D725:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}

static void unk_8D72D()
{
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("MOV	DX,AX");
	ASM_INLINE("XOR	SI,SI");
	ASM_INLINE("JMP	_8D743");
ASM_INLINE("_8D736:");
	ASM_INLINE("MOV	AX,DX");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
	ASM_INLINE("INC	SI");
ASM_INLINE("_8D743:");
	ASM_INLINE("CMP	SI,0x0010");
	ASM_INLINE("JL	_8D736");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

void stage_select_init()
{
	task_delete; //Force include
	memalloc; //Force include
	task_append; //Force include
	stage_get; //Force include
	nbg_ddf; //Force include
	spr_ddf; //Force include
	bitmap; //Force include
	font_put2; //Force include
	fade_out; //Force include
	fade_tone; //Force include
	fade_run; //Force include
	fade_in; //Force include
	bgmreq; //Force include
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("CALLF	task_delete_, SEG task_delete_");
	ASM_INLINE("MOV	AX,0x0004");
	ASM_INLINE("CALLF	memalloc_, SEG memalloc_");
	ASM_INLINE("MOV	SI,AX");
	ASM_INLINE("TEST	SI,SI");
	ASM_INLINE("JNZ	_8D765");
	ASM_INLINE("JMP	_8D826");
ASM_INLINE("_8D765:");
	ASM_INLINE("MOV	AX,unk_8D82A_");
	ASM_INLINE("MOV	BX,SEG unk_8D82A_");
	ASM_INLINE("MOV	CX,SI");
	ASM_INLINE("CALLF	task_append_, SEG task_append_");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("CALLF	stage_get_, SEG stage_get_");
	ASM_INLINE("MOV	[SI].W,AX");
	ASM_INLINE("MOV	BX,SI");
	ASM_INLINE("MOV	AX,[BX].W");
	ASM_INLINE("MOV	[SI+0x02].W,AX");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	nbg_ddf_, SEG nbg_ddf_");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	nbg_ddf_, SEG nbg_ddf_");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("CALLF	spr_ddf_, SEG spr_ddf_");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("CALLF	bitmap_, SEG bitmap_");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("MOV	CX,0x0000");
	ASM_INLINE("MOV	DX,0xBA51");
	ASM_INLINE("CALLF	font_put2_, SEG font_put2_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("CALLF	unk_8D72D_, SEG unk_8D72D_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,[SI].W");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("CALL	unk_8CFD3_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALL	unk_8D03D_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALL	unk_8D03D_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("CALLF	unk_8D213_, SEG unk_8D213_");
	ASM_INLINE("MOV	AX,SI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	unk_8D213_, SEG unk_8D213_");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("CALLF	fade_tone_, SEG fade_tone_");
	ASM_INLINE("MOV	AX,0x0064");
	ASM_INLINE("CALLF	fade_out_, SEG fade_out_");
	ASM_INLINE("CALLF	fade_run_, SEG fade_run_");
	ASM_INLINE("MOV	AX,0x000A");
	ASM_INLINE("CALLF	fade_in_, SEG fade_in_");
	ASM_INLINE("XOR	AX,AX");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	nbg_ddf_, SEG nbg_ddf_");
	ASM_INLINE("MOV	AX,0x0001");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	nbg_ddf_, SEG nbg_ddf_");
	ASM_INLINE("MOV	AL,0x02");
	ASM_INLINE("CALLF	bgmreq_, SEG bgmreq_");
ASM_INLINE("_8D826:");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
}

static void unk_8D82A()
{
	sereq; //Force include
	memfree; //Force include
	task_delete_fade; //Force include
	story_init; //Force include
	tuneup_init; //Force include
	unisel_init; //Force include
	ASM_INLINE("PUSH	BP");
	ASM_INLINE("MOV	BP,SP");
	ASM_INLINE("SUB	SP,0x0004");
	ASM_INLINE("PUSH	CX");
	ASM_INLINE("PUSH	DX");
	ASM_INLINE("PUSH	SI");
	ASM_INLINE("PUSH	DI");
	ASM_INLINE("MOV	DI,AX");
	ASM_INLINE("TEST	[0x0956].W,0x0004");
	ASM_INLINE("JNZ	_8D841");
	ASM_INLINE("JMP	_8D92B");
ASM_INLINE("_8D841:");
	ASM_INLINE("MOV	AX,[DI].W");
	ASM_INLINE("MOV	[0x1E09].B,AL");
	ASM_INLINE("MOV	[0x1E08].B,0x00");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AL,[0x1E0A].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	BX,0x001D");
	ASM_INLINE("MUL	BX");
	ASM_INLINE("MOV	BX,AX");
	ASM_INLINE("ADD	BX,0x1E3C");
	ASM_INLINE("MOV	AL,[BX+0x01].B");
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("TEST	AX,AX");
	ASM_INLINE("JZ	_8D870");
	ASM_INLINE("MOV	BX,0x0010");
	ASM_INLINE("JMP	_8D872");
ASM_INLINE("_8D870:");
	ASM_INLINE("XOR	BX,BX");
ASM_INLINE("_8D872:");
	ASM_INLINE("ADD	BX,[DI].W");
	ASM_INLINE("MOV	AX,0xA79D");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x000A].B");
	ASM_OP5(0x26,0x8A,0x87,0x0A,0x00);
	ASM_INLINE("XOR	AH,AH");
	ASM_INLINE("MOV	CX,0x000F");
	ASM_INLINE("MUL	CX");
	ASM_INLINE("SUB	AX,0x000F");
	ASM_INLINE("MOV	DX,0x0004");
	ASM_INLINE("MOV	CX,0xA751");
	ASM_INLINE("ADD	DX,AX");
	ASM_INLINE("MOV	[BP-0x04].W,DX");
	ASM_INLINE("MOV	[BP-0x02].W,CX");
	ASM_INLINE("MOV	AX,0xA79D");
	ASM_INLINE("MOV	ES,AX");
	//ASM_INLINE("MOV	AL,ES:[BX+0x000A].B");
	ASM_OP5(0x26,0x8A,0x87,0x0A,0x00);
	ASM_INLINE("DEC	AL");
	ASM_INLINE("MOV	[0x1E3C].B,AL");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	AL,ES:[BX+0x02].B");
	ASM_INLINE("MOV	[0x1E3E].B,AL");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("MOV	AL,ES:[BX+0x03].B");
	ASM_INLINE("MOV	[0x1E3F].B,AL");
	ASM_INLINE("MOV	[0x1E40].B,0xFF");
	ASM_INLINE("XOR	SI,SI");
	ASM_INLINE("JMP	_8D8D2");
ASM_INLINE("_8D8C2:");
	ASM_INLINE("LES	BX,[BP-0x04]");
	ASM_INLINE("ADD	BX,0x0005");
	ASM_INLINE("ADD	BX,SI");
	ASM_INLINE("MOV	AL,ES:[BX].B");
	ASM_INLINE("MOV	[SI+0x1E41].B,AL");
	ASM_INLINE("INC	SI");
ASM_INLINE("_8D8D2:");
	ASM_INLINE("CMP	SI,0x0008");
	ASM_INLINE("JL	_8D8C2");
	ASM_INLINE("XOR	BX,BX");
	ASM_INLINE("JMP	_8D8E1");
ASM_INLINE("_8D8DB:");
	ASM_INLINE("MOV	[BX+0x1E49].B,0xFF");
	ASM_INLINE("INC	BX");
ASM_INLINE("_8D8E1:");
	ASM_INLINE("CMP	BX,0x0010");
	ASM_INLINE("JL	_8D8DB");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("CALLF	memfree_, SEG memfree_");
	ASM_INLINE("CALLF	task_delete_, SEG task_delete_");
	ASM_INLINE("MOV	AL,[0x1E07].B");
	ASM_INLINE("CMP	AL,0x03");
	ASM_INLINE("JZ	_8D923");
	ASM_INLINE("CMP	AL,0x02");
	ASM_INLINE("JZ	_8D923");
	ASM_INLINE("CMP	AL,0x01");
	ASM_INLINE("JZ	_8D914");
	ASM_INLINE("TEST	AL,AL");
	ASM_INLINE("JNZ	_8D923");
	ASM_INLINE("MOV	AX,story_init_");
	ASM_INLINE("MOV	BX,SEG story_init_");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	task_append_, SEG task_append_");
	ASM_INLINE("JMP	_8D923");
ASM_INLINE("_8D914:");
	ASM_INLINE("MOV	AX,tuneup_init_");
	ASM_INLINE("MOV	BX,SEG tuneup_init_");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	task_append_, SEG task_append_");
	ASM_INLINE("JMP	_8D923");
ASM_INLINE("_8D923:");
	ASM_INLINE("MOV	AX,0x000A");
	ASM_INLINE("CALLF	task_delete_fade_, SEG task_delete_fade_");
ASM_INLINE("_8D92B:");
	ASM_INLINE("TEST	[0x0956].W,0x0008");
	ASM_INLINE("JZ	_8D95B");
	ASM_INLINE("MOV	AL,0x0A");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("CALLF	memfree_, SEG memfree_");
	ASM_INLINE("CALLF	task_delete_, SEG task_delete_");
	ASM_INLINE("MOV	AX,unisel_init_");
	ASM_INLINE("MOV	BX,SEG unisel_init_");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	task_append_, SEG task_append_");
	ASM_INLINE("MOV	AX,0x000A");
	ASM_INLINE("CALLF	task_delete_fade_, SEG task_delete_fade_");
ASM_INLINE("_8D95B:");
	ASM_INLINE("TEST	[0x0956].W,0x0100");
	ASM_INLINE("JZ	_8D99A");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("CMP	[DI].W,0x0000");
	ASM_INLINE("JLE	_8D99A");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
	ASM_INLINE("DEC	[DI].W");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALL	unk_8D03D_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	unk_8D213_, SEG unk_8D213_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
ASM_INLINE("_8D99A:");
	ASM_INLINE("TEST	[0x0956].W,0x0400");
	ASM_INLINE("JZ	_8D9DB");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,[DI].W");
	ASM_INLINE("CMP	AX,[DI+0x02].W");
	ASM_INLINE("JGE	_8D9DB");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
	ASM_INLINE("INC	[DI].W");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALL	unk_8D03D_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	unk_8D213_, SEG unk_8D213_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
ASM_INLINE("_8D9DB:");
	ASM_INLINE("TEST	[0x0956].W,0x0800");
	ASM_INLINE("JZ	_8DA1B");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("CMP	[DI].W,0x0007");
	ASM_INLINE("JLE	_8DA1B");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
	ASM_INLINE("SUB	[DI].W,0x0008");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALL	unk_8D03D_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	unk_8D213_, SEG unk_8D213_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
ASM_INLINE("_8DA1B:");
	ASM_INLINE("TEST	[0x0956].W,0x0200");
	ASM_INLINE("JZ	_8DA60");
	ASM_INLINE("MOV	AL,0x0C");
	ASM_INLINE("CALLF	sereq_, SEG sereq_");
	ASM_INLINE("MOV	AX,[DI].W");
	ASM_INLINE("ADD	AX,0x0007");
	ASM_INLINE("CMP	AX,[DI+0x02].W");
	ASM_INLINE("JGE	_8DA60");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("MOV	CX,0x0001");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
	ASM_INLINE("ADD	[DI].W,0x0008");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALL	unk_8D03D_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,0x0001");
	ASM_INLINE("CALLF	unk_8D213_, SEG unk_8D213_");
	ASM_INLINE("MOV	AX,DI");
	ASM_INLINE("MOV	BX,[DI].W");
	ASM_INLINE("XOR	CX,CX");
	ASM_INLINE("CALLF	unk_8D314_, SEG unk_8D314_");
ASM_INLINE("_8DA60:");
	ASM_INLINE("POP	DI");
	ASM_INLINE("POP	SI");
	ASM_INLINE("POP	DX");
	ASM_INLINE("POP	CX");
	ASM_INLINE("MOV	SP,BP");
	ASM_INLINE("POP	BP");
}
